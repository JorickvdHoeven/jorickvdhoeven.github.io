<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Python 102 - Plotting data on a map – Jorick van der Hoeven</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-139760d7c2b45b71cf6fb5fb69731804.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="dark">
<link href="../../../site_libs/bootstrap/bootstrap-dark-a9957ab5e8b7c67643b7e2e6b5c1e54e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Python 102 - Plotting data on a map – Jorick van der Hoeven">
<meta property="og:description" content="">
<meta property="og:site_name" content="Jorick van der Hoeven">
</head>

<body class="nav-fixed fullcontent quarto-dark"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = true;
    const darkModeDefault = authorPrefersDark;
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Jorick van der Hoeven</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../portfolio.html"> 
<span class="menu-text">Portfolio</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/JorickvdHoeven"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Python 102 - Plotting data on a map</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Before you start make sure that you have run the following commands in anaconda prompt:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> activate analysis-101</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install git</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="ex">conda</span> install pycountry</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/CSSEGISandData/COVID-19.git us_jhu_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="explore-environment-and-downloaded-data" class="level3">
<h3 class="anchored" data-anchor-id="explore-environment-and-downloaded-data">Explore environment and downloaded data</h3>
<p>As with any downloaded data, it’s prudent to explore a little what data we received and wehther there are obvious patterns.</p>
<p>Let’s start by exploring what we see from our notebook. We can do this using the jupyter magic command %ls which behaves like the Unix ls command or similar to the Windows DIR command listing directories from where the notebook is opened from.</p>
<div id="cell-3" class="cell" data-scrolled="true" data-tags="[]" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>ls </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="ansi-escaped-output">
<pre>AR_pyTemplate.xlsx                  introduction-to-SIR-models-2.ipynb
choropleth_1.html                   introduction-to-SIR-models-3.ipynb
choropleth_2.html                   mapping-data-with-plotly.ipynb
choropleth_3.html                   <span class="ansi-blue-fg">us_jhu_data</span>/
introduction-to-SIR-models-1.ipynb
</pre>
</div>
</div>
</div>
<p>So it looks like we’re in our own folder, we’ve got our notebook and the data we just downloaded, let’s have a look inside.</p>
<div id="cell-5" class="cell" data-scrolled="true" data-tags="[]" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>ls us_jhu_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="ansi-escaped-output">
<pre>README.md                       <span class="ansi-blue-fg">csse_covid_19_data</span>/
<span class="ansi-blue-fg">archived_data</span>/                  <span class="ansi-blue-fg">who_covid_19_situation_reports</span>/
</pre>
</div>
</div>
</div>
<p>That command wasn’t super helpful, all we got back from it was a list of more folders to look into. Let’s just go nuclear and look at everything together. To do that we can use the -R switch to expand all the files and folders.</p>
<div id="cell-7" class="cell" data-scrolled="true" data-tags="[]" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>ls <span class="op">-</span>R us_jhu_data<span class="op">/</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># %ls /S us_jhu_data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<div class="ansi-escaped-output">
<pre>README.md                       <span class="ansi-blue-fg">csse_covid_19_data</span>/
<span class="ansi-blue-fg">archived_data</span>/                  <span class="ansi-blue-fg">who_covid_19_situation_reports</span>/

us_jhu_data//archived_data:
README.md                    <span class="ansi-blue-fg">archived_time_series</span>/
<span class="ansi-blue-fg">archived_daily_case_updates</span>/

us_jhu_data//archived_data/archived_daily_case_updates:
01-21-2020_2200.csv  01-29-2020_1430.csv  02-06-2020_1318.csv
01-22-2020_1200.csv  01-29-2020_2100.csv  02-06-2020_2005.csv
01-23-2020_1200.csv  01-30-2020_1100.csv  02-07-2020_2024.csv
01-24-2020_0000.csv  01-30-2020_2130.csv  02-08-2020_1024.csv
01-24-2020_1200.csv  01-31-2020_1400.csv  02-08-2020_2304.csv
01-25-2020_0000.csv  02-01-2020_1000.csv  02-09-2020_1030.csv
01-25-2020_1200.csv  02-01-2020_1800.csv  02-09-2020_2320.csv
01-25-2020_2200.csv  02-01-2020_2300.csv  02-10-2020_1030.csv
01-26-2020_1100.csv  02-02-2020_0500.csv  02-10-2020_1930.csv
01-26-2020_2300.csv  02-02-2020_1945.csv  02-11-2020_1050.csv
01-27-2020_0900.csv  02-02-2020_2100.csv  02-11-2020_2044.csv
01-27-2020_1900.csv  02-03-2020_1230.csv  02-12-2020_1020.csv
01-27-2020_2030.csv  02-03-2020_2140.csv  02-12-2020_2200.csv
01-28-2020_1300.csv  02-04-2020_0800.csv  02-13-2020_1000.csv
01-28-2020_1800.csv  02-04-2020_1150.csv  02-13-2020_2115.csv
01-28-2020_2300.csv  02-04-2020_2200.csv  02-14-2020_1123.csv
01-29-2020_1330.csv  02-05-2020_1220.csv  README.md

us_jhu_data//archived_data/archived_time_series:
README.md
time_series_19-covid-Confirmed_archived_0325.csv
time_series_19-covid-Deaths_archived_0325.csv
time_series_19-covid-Recovered_archived_0325.csv
time_series_2019-ncov-Confirmed.csv
time_series_2019-ncov-Deaths.csv
time_series_2019-ncov-Recovered.csv

us_jhu_data//csse_covid_19_data:
README.md                       <span class="ansi-blue-fg">csse_covid_19_daily_reports_us</span>/
UID_ISO_FIPS_LookUp_Table.csv   <span class="ansi-blue-fg">csse_covid_19_time_series</span>/
<span class="ansi-blue-fg">csse_covid_19_daily_reports</span>/

us_jhu_data//csse_covid_19_data/csse_covid_19_daily_reports:
01-22-2020.csv  02-09-2020.csv  02-27-2020.csv  03-16-2020.csv  04-03-2020.csv
01-23-2020.csv  02-10-2020.csv  02-28-2020.csv  03-17-2020.csv  04-04-2020.csv
01-24-2020.csv  02-11-2020.csv  02-29-2020.csv  03-18-2020.csv  04-05-2020.csv
01-25-2020.csv  02-12-2020.csv  03-01-2020.csv  03-19-2020.csv  04-06-2020.csv
01-26-2020.csv  02-13-2020.csv  03-02-2020.csv  03-20-2020.csv  04-07-2020.csv
01-27-2020.csv  02-14-2020.csv  03-03-2020.csv  03-21-2020.csv  04-08-2020.csv
01-28-2020.csv  02-15-2020.csv  03-04-2020.csv  03-22-2020.csv  04-09-2020.csv
01-29-2020.csv  02-16-2020.csv  03-05-2020.csv  03-23-2020.csv  04-10-2020.csv
01-30-2020.csv  02-17-2020.csv  03-06-2020.csv  03-24-2020.csv  04-11-2020.csv
01-31-2020.csv  02-18-2020.csv  03-07-2020.csv  03-25-2020.csv  04-12-2020.csv
02-01-2020.csv  02-19-2020.csv  03-08-2020.csv  03-26-2020.csv  04-13-2020.csv
02-02-2020.csv  02-20-2020.csv  03-09-2020.csv  03-27-2020.csv  04-14-2020.csv
02-03-2020.csv  02-21-2020.csv  03-10-2020.csv  03-28-2020.csv  04-15-2020.csv
02-04-2020.csv  02-22-2020.csv  03-11-2020.csv  03-29-2020.csv  README.md
02-05-2020.csv  02-23-2020.csv  03-12-2020.csv  03-30-2020.csv
02-06-2020.csv  02-24-2020.csv  03-13-2020.csv  03-31-2020.csv
02-07-2020.csv  02-25-2020.csv  03-14-2020.csv  04-01-2020.csv
02-08-2020.csv  02-26-2020.csv  03-15-2020.csv  04-02-2020.csv

us_jhu_data//csse_covid_19_data/csse_covid_19_daily_reports_us:
04-12-2020.csv  04-13-2020.csv  04-14-2020.csv  04-15-2020.csv  README.md

us_jhu_data//csse_covid_19_data/csse_covid_19_time_series:
README.md
time_series_covid19_confirmed_US.csv
time_series_covid19_confirmed_global.csv
time_series_covid19_deaths_US.csv
time_series_covid19_deaths_global.csv
time_series_covid19_recovered_global.csv

us_jhu_data//who_covid_19_situation_reports:
README.md                         <span class="ansi-blue-fg">who_covid_19_sit_rep_time_series</span>/
<span class="ansi-blue-fg">who_covid_19_sit_rep_pdfs</span>/

us_jhu_data//who_covid_19_situation_reports/who_covid_19_sit_rep_pdfs:
20200121-sitrep-1-2019-ncov.pdf     20200222-sitrep-33-covid-19.pdf
20200122-sitrep-2-2019-ncov.pdf     20200223-sitrep-34-covid-19.pdf
20200123-sitrep-3-2019-ncov.pdf     20200224-sitrep-35-covid-19.pdf
20200124-sitrep-4-2019-ncov.pdf     20200225-sitrep-36-covid-19.pdf
20200125-sitrep-5-2019-ncov.pdf     20200226-sitrep-37-covid-19.pdf
20200126-sitrep-6-2019--ncov.pdf    20200227-sitrep-38-covid-19.pdf
20200127-sitrep-7-2019--ncov.pdf    20200228-sitrep-39-covid-19.pdf
20200128-sitrep-8-ncov-cleared.pdf  20200229-sitrep-40-covid-19.pdf
20200129-sitrep-9-ncov-v2.pdf       20200301-sitrep-41-covid-19.pdf
20200130-sitrep-10-ncov.pdf         20200302-sitrep-42-covid-19.pdf
20200131-sitrep-11-ncov.pdf         20200303-sitrep-43-covid-19.pdf
20200201-sitrep-12-ncov.pdf         20200304-sitrep-44-covid-19.pdf
20200202-sitrep-13-ncov-v3.pdf      20200305-sitrep-45-covid-19.pdf
20200203-sitrep-14-ncov.pdf         20200306-sitrep-46-covid-19.pdf
20200204-sitrep-15-ncov.pdf         20200307-sitrep-47-covid-19.pdf
20200205-sitrep-16-ncov.pdf         20200308-sitrep-48-covid-19.pdf
20200206-sitrep-17-ncov.pdf         20200309-sitrep-49-covid-19.pdf
20200207-sitrep-18-ncov.pdf         20200310-sitrep-50-covid-19.pdf
20200208-sitrep-19-ncov.pdf         20200311-sitrep-51-covid-19.pdf
20200209-sitrep-20-ncov.pdf         20200312-sitrep-52-covid-19.pdf
20200210-sitrep-21-ncov.pdf         20200313-sitrep-53-covid-19.pdf
20200211-sitrep-22-ncov.pdf         20200314-sitrep-54-covid-19.pdf
20200212-sitrep-23-ncov.pdf         20200315-sitrep-55-covid-19.pdf
20200213-sitrep-24-covid-19.pdf     20200316-sitrep-56-covid-19.pdf
20200214-sitrep-25-covid-19.pdf     20200317-sitrep-57-covid-19.pdf
20200215-sitrep-26-covid-19.pdf     20200318-sitrep-58-covid-19.pdf
20200216-sitrep-27-covid-19.pdf     20200319-sitrep-59-covid-19.pdf
20200217-sitrep-28-covid-19.pdf     20200320-sitrep-60-covid-19.pdf
20200218-sitrep-29-covid-19.pdf     20200321-sitrep-61-covid-19.pdf
20200219-sitrep-30-covid-19.pdf     20200322-sitrep-62-covid-19.pdf
20200220-sitrep-31-covid-19.pdf     20200323-sitrep-63-covid-19.pdf
20200221-sitrep-32-covid-19.pdf     20200324-sitrep-64-covid-19.pdf

us_jhu_data//who_covid_19_situation_reports/who_covid_19_sit_rep_time_series:
who_covid_19_sit_rep_time_series.csv
</pre>
</div>
</div>
</div>
<p>From the output of ls we can see that we have the following data sets: - archived daily case updates - archived time series data - a lookup table to convert IDs to US FIPS codes (county codes) - daily reports from jan 22 to april 10 - time series data with different focuses - unstructured WHO situation reports - WHO structured time series of the situation reports</p>
<p>For brevity, we will only explore the following two data sets: - time series data with different focuses - daily reports from jan 22 to april 10</p>
<p>Let’s start with the global time series data</p>
</section>
<section id="start-the-python-engines-import-libararies" class="level3">
<h3 class="anchored" data-anchor-id="start-the-python-engines-import-libararies">Start the Python engines, import libararies</h3>
<p>Before we start we need to load the libararies we need. Below are a collection of libraries that I reach for time and time again so it’s generally prudent to load them first so that we don’t end up needing to load them later.</p>
<div id="cell-10" class="cell" data-scrolled="true" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas_profiling <span class="im">import</span> ProfileReport</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="global-time-series-data" class="level4">
<h4 class="anchored" data-anchor-id="global-time-series-data">Global time series data</h4>
<div id="cell-12" class="cell" data-scrolled="true" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pd.read_csv(<span class="st">'us_jhu_data/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv'</span>)<span class="op">\</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  .head()</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#'us_jhu_data//csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv' this file</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># will be left to participants as an exercise.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Province/State</th>
<th data-quarto-table-cell-role="th">Country/Region</th>
<th data-quarto-table-cell-role="th">Lat</th>
<th data-quarto-table-cell-role="th">Long</th>
<th data-quarto-table-cell-role="th">1/22/20</th>
<th data-quarto-table-cell-role="th">1/23/20</th>
<th data-quarto-table-cell-role="th">1/24/20</th>
<th data-quarto-table-cell-role="th">1/25/20</th>
<th data-quarto-table-cell-role="th">1/26/20</th>
<th data-quarto-table-cell-role="th">1/27/20</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">4/6/20</th>
<th data-quarto-table-cell-role="th">4/7/20</th>
<th data-quarto-table-cell-role="th">4/8/20</th>
<th data-quarto-table-cell-role="th">4/9/20</th>
<th data-quarto-table-cell-role="th">4/10/20</th>
<th data-quarto-table-cell-role="th">4/11/20</th>
<th data-quarto-table-cell-role="th">4/12/20</th>
<th data-quarto-table-cell-role="th">4/13/20</th>
<th data-quarto-table-cell-role="th">4/14/20</th>
<th data-quarto-table-cell-role="th">4/15/20</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>Afghanistan</td>
<td>33.0000</td>
<td>65.0000</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>367</td>
<td>423</td>
<td>444</td>
<td>484</td>
<td>521</td>
<td>555</td>
<td>607</td>
<td>665</td>
<td>714</td>
<td>784</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>Albania</td>
<td>41.1533</td>
<td>20.1683</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>377</td>
<td>383</td>
<td>400</td>
<td>409</td>
<td>416</td>
<td>433</td>
<td>446</td>
<td>467</td>
<td>475</td>
<td>494</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>Algeria</td>
<td>28.0339</td>
<td>1.6596</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>1423</td>
<td>1468</td>
<td>1572</td>
<td>1666</td>
<td>1761</td>
<td>1825</td>
<td>1914</td>
<td>1983</td>
<td>2070</td>
<td>2160</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>Andorra</td>
<td>42.5063</td>
<td>1.5218</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>525</td>
<td>545</td>
<td>564</td>
<td>583</td>
<td>601</td>
<td>601</td>
<td>638</td>
<td>646</td>
<td>659</td>
<td>673</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>Angola</td>
<td>-11.2027</td>
<td>17.8739</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>...</td>
<td>16</td>
<td>17</td>
<td>19</td>
<td>19</td>
<td>19</td>
<td>19</td>
<td>19</td>
<td>19</td>
<td>19</td>
<td>19</td>
</tr>
</tbody>
</table>

<p>5 rows × 89 columns</p>
</div>
</div>
</div>
<p>This file has almost exactly what we need, but it’s kind of cheating, so let’s use the other dataset, the daily reports and clean that data up for us to use in a mapping exercise.</p>
</section>
</section>
<section id="explore-chosen-dataset-daily-reports" class="level3">
<h3 class="anchored" data-anchor-id="explore-chosen-dataset-daily-reports">Explore chosen dataset – Daily Reports</h3>
<p>Let’s start by peeking into one file and having a look at what’s in there</p>
<div id="cell-16" class="cell" data-scrolled="true" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>idata <span class="op">=</span> <span class="st">'us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-17" class="cell" data-scrolled="true" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pd.read_csv(os.path.join(idata,<span class="st">'03-13-2020.csv'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Province/State</th>
<th data-quarto-table-cell-role="th">Country/Region</th>
<th data-quarto-table-cell-role="th">Last Update</th>
<th data-quarto-table-cell-role="th">Confirmed</th>
<th data-quarto-table-cell-role="th">Deaths</th>
<th data-quarto-table-cell-role="th">Recovered</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Longitude</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Hubei</td>
<td>China</td>
<td>2020-03-13T11:09:03</td>
<td>67786</td>
<td>3062</td>
<td>51553</td>
<td>30.9756</td>
<td>112.2707</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Guangdong</td>
<td>China</td>
<td>2020-03-13T11:09:03</td>
<td>1356</td>
<td>8</td>
<td>1296</td>
<td>23.3417</td>
<td>113.4244</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Henan</td>
<td>China</td>
<td>2020-03-11T08:13:09</td>
<td>1273</td>
<td>22</td>
<td>1249</td>
<td>33.8820</td>
<td>113.6140</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Zhejiang</td>
<td>China</td>
<td>2020-03-12T01:33:02</td>
<td>1215</td>
<td>1</td>
<td>1197</td>
<td>29.1832</td>
<td>120.0934</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Hunan</td>
<td>China</td>
<td>2020-03-13T11:09:03</td>
<td>1018</td>
<td>4</td>
<td>1005</td>
<td>27.6104</td>
<td>111.7088</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">225</td>
<td>NaN</td>
<td>Afghanistan</td>
<td>2020-03-11T20:00:00</td>
<td>7</td>
<td>0</td>
<td>0</td>
<td>33.0000</td>
<td>65.0000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">226</td>
<td>NaN</td>
<td>Monaco</td>
<td>2020-03-11T20:00:00</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>43.7333</td>
<td>7.4167</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">227</td>
<td>NaN</td>
<td>Liechtenstein</td>
<td>2020-03-11T20:00:00</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>47.1400</td>
<td>9.5500</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">228</td>
<td>NaN</td>
<td>Guyana</td>
<td>2020-03-11T20:00:00</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>5.0000</td>
<td>-58.7500</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">229</td>
<td>NaN</td>
<td>Taiwan*</td>
<td>2020-03-11T20:00:00</td>
<td>50</td>
<td>1</td>
<td>20</td>
<td>23.7000</td>
<td>121.0000</td>
</tr>
</tbody>
</table>

<p>230 rows × 8 columns</p>
</div>
</div>
</div>
<p>Check the size and column count for all the files</p>
<div id="cell-19" class="cell" data-scrolled="true" data-tags="[]" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>dataset_path <span class="op">=</span> os.path.join(idata,<span class="st">'*.csv'</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> glob.glob(dataset_path):</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>( pd.read_csv(<span class="bu">file</span>).shape) <span class="co"># calculate data shape (rows, columns)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(101, 6)
(105, 6)
(2883, 12)
(2911, 12)
(75, 6)
(76, 6)
(3416, 12)
(3420, 12)
(2569, 12)
(2625, 12)
(206, 8)
(216, 8)
(73, 6)
(74, 6)
(225, 8)
(199, 8)
(3027, 12)
(3014, 12)
(71, 6)
(70, 6)
(72, 6)
(72, 6)
(125, 8)
(2989, 12)
(3002, 12)
(67, 6)
(68, 6)
(62, 6)
(58, 6)
(84, 6)
(76, 6)
(3413, 12)
(3417, 12)
(2764, 12)
(2679, 12)
(276, 8)
(272, 8)
(75, 6)
(75, 6)
(47, 6)
(51, 6)
(3434, 12)
(3430, 12)
(160, 8)
(173, 8)
(71, 6)
(72, 6)
(3439, 12)
(2434, 12)
(2483, 12)
(230, 8)
(218, 8)
(38, 6)
(46, 6)
(73, 6)
(72, 6)
(94, 6)
(90, 6)
(292, 8)
(284, 8)
(52, 6)
(54, 6)
(3429, 12)
(3421, 12)
(2809, 12)
(2857, 12)
(114, 6)
(119, 6)
(249, 8)
(258, 8)
(44, 6)
(41, 6)
(75, 6)
(75, 6)
(84, 6)
(85, 6)
(299, 8)
(304, 8)
(151, 8)
(141, 8)
(2966, 12)
(2942, 12)
(67, 6)
(266, 8)
(255, 8)</code></pre>
</div>
</div>
<div id="cell-20" class="cell" data-scrolled="true" data-tags="[]" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> glob.glob(dataset_path):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="bu">file</span> <span class="co"># print file path</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>          , pd.read_csv(<span class="bu">file</span>).shape) <span class="co"># calculate data shape (rows, columns)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-26-2020.csv (101, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-27-2020.csv (105, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-08-2020.csv (2883, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-09-2020.csv (2911, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-18-2020.csv (75, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-19-2020.csv (76, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-24-2020.csv (3416, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-25-2020.csv (3420, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-02-2020.csv (2569, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-03-2020.csv (2625, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-10-2020.csv (206, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-11-2020.csv (216, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-12-2020.csv (73, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-13-2020.csv (74, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-07-2020.csv (225, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-06-2020.csv (199, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv (3027, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-14-2020.csv (3014, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-05-2020.csv (71, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-04-2020.csv (70, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-08-2020.csv (72, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-09-2020.csv (72, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-01-2020.csv (125, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-12-2020.csv (2989, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-13-2020.csv (3002, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-02-2020.csv (67, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-03-2020.csv (68, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-31-2020.csv (62, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-30-2020.csv (58, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-21-2020.csv (84, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-20-2020.csv (76, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-23-2020.csv (3413, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-22-2020.csv (3417, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-05-2020.csv (2764, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-04-2020.csv (2679, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-17-2020.csv (276, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-16-2020.csv (272, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-15-2020.csv (75, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-14-2020.csv (75, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-26-2020.csv (47, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-27-2020.csv (51, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-29-2020.csv (3434, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-28-2020.csv (3430, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-04-2020.csv (160, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-05-2020.csv (173, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-06-2020.csv (71, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-07-2020.csv (72, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-30-2020.csv (3439, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-31-2020.csv (2434, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-01-2020.csv (2483, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-13-2020.csv (230, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-12-2020.csv (218, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv (38, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-23-2020.csv (46, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-11-2020.csv (73, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-10-2020.csv (72, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-25-2020.csv (94, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-24-2020.csv (90, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-19-2020.csv (292, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-18-2020.csv (284, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-28-2020.csv (52, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-29-2020.csv (54, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-27-2020.csv (3429, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-26-2020.csv (3421, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-06-2020.csv (2809, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-07-2020.csv (2857, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-28-2020.csv (114, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-29-2020.csv (119, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-14-2020.csv (249, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-15-2020.csv (258, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-25-2020.csv (44, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-24-2020.csv (41, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-16-2020.csv (75, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-17-2020.csv (75, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-22-2020.csv (84, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-23-2020.csv (85, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-20-2020.csv (299, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-21-2020.csv (304, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-03-2020.csv (151, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-02-2020.csv (141, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-11-2020.csv (2966, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-10-2020.csv (2942, 12)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-01-2020.csv (67, 6)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-09-2020.csv (266, 8)
us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-08-2020.csv (255, 8)</code></pre>
</div>
</div>
<div id="cell-21" class="cell" data-scrolled="true" data-tags="[]" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> glob.glob(dataset_path):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="bu">file</span>.rsplit(os.path.sep,<span class="dv">1</span>)[<span class="dv">1</span>] <span class="co"># isolate file name</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>          , pd.read_csv(<span class="bu">file</span>).shape) <span class="co"># calculate data shape (rows, columns)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>02-26-2020.csv (101, 6)
02-27-2020.csv (105, 6)
04-08-2020.csv (2883, 12)
04-09-2020.csv (2911, 12)
02-18-2020.csv (75, 6)
02-19-2020.csv (76, 6)
03-24-2020.csv (3416, 12)
03-25-2020.csv (3420, 12)
04-02-2020.csv (2569, 12)
04-03-2020.csv (2625, 12)
03-10-2020.csv (206, 8)
03-11-2020.csv (216, 8)
02-12-2020.csv (73, 6)
02-13-2020.csv (74, 6)
03-07-2020.csv (225, 8)
03-06-2020.csv (199, 8)
04-15-2020.csv (3027, 12)
04-14-2020.csv (3014, 12)
02-05-2020.csv (71, 6)
02-04-2020.csv (70, 6)
02-08-2020.csv (72, 6)
02-09-2020.csv (72, 6)
03-01-2020.csv (125, 8)
04-12-2020.csv (2989, 12)
04-13-2020.csv (3002, 12)
02-02-2020.csv (67, 6)
02-03-2020.csv (68, 6)
01-31-2020.csv (62, 6)
01-30-2020.csv (58, 6)
02-21-2020.csv (84, 6)
02-20-2020.csv (76, 6)
03-23-2020.csv (3413, 12)
03-22-2020.csv (3417, 12)
04-05-2020.csv (2764, 12)
04-04-2020.csv (2679, 12)
03-17-2020.csv (276, 8)
03-16-2020.csv (272, 8)
02-15-2020.csv (75, 6)
02-14-2020.csv (75, 6)
01-26-2020.csv (47, 6)
01-27-2020.csv (51, 6)
03-29-2020.csv (3434, 12)
03-28-2020.csv (3430, 12)
03-04-2020.csv (160, 8)
03-05-2020.csv (173, 8)
02-06-2020.csv (71, 6)
02-07-2020.csv (72, 6)
03-30-2020.csv (3439, 12)
03-31-2020.csv (2434, 12)
04-01-2020.csv (2483, 12)
03-13-2020.csv (230, 8)
03-12-2020.csv (218, 8)
01-22-2020.csv (38, 6)
01-23-2020.csv (46, 6)
02-11-2020.csv (73, 6)
02-10-2020.csv (72, 6)
02-25-2020.csv (94, 6)
02-24-2020.csv (90, 6)
03-19-2020.csv (292, 8)
03-18-2020.csv (284, 8)
01-28-2020.csv (52, 6)
01-29-2020.csv (54, 6)
03-27-2020.csv (3429, 12)
03-26-2020.csv (3421, 12)
04-06-2020.csv (2809, 12)
04-07-2020.csv (2857, 12)
02-28-2020.csv (114, 6)
02-29-2020.csv (119, 6)
03-14-2020.csv (249, 8)
03-15-2020.csv (258, 8)
01-25-2020.csv (44, 6)
01-24-2020.csv (41, 6)
02-16-2020.csv (75, 6)
02-17-2020.csv (75, 6)
02-22-2020.csv (84, 6)
02-23-2020.csv (85, 6)
03-20-2020.csv (299, 8)
03-21-2020.csv (304, 8)
03-03-2020.csv (151, 8)
03-02-2020.csv (141, 8)
04-11-2020.csv (2966, 12)
04-10-2020.csv (2942, 12)
02-01-2020.csv (67, 6)
03-09-2020.csv (266, 8)
03-08-2020.csv (255, 8)</code></pre>
</div>
</div>
<div id="cell-22" class="cell" data-scrolled="true" data-tags="[]" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the file list</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> <span class="bu">sorted</span>(glob.glob(dataset_path)):</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="bu">file</span>.rsplit(os.path.sep,<span class="dv">1</span>)[<span class="dv">1</span>] <span class="co"># isolate file name</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>          , pd.read_csv(<span class="bu">file</span>).shape) <span class="co"># calculate data shape (rows, columns)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>01-22-2020.csv (38, 6)
01-23-2020.csv (46, 6)
01-24-2020.csv (41, 6)
01-25-2020.csv (44, 6)
01-26-2020.csv (47, 6)
01-27-2020.csv (51, 6)
01-28-2020.csv (52, 6)
01-29-2020.csv (54, 6)
01-30-2020.csv (58, 6)
01-31-2020.csv (62, 6)
02-01-2020.csv (67, 6)
02-02-2020.csv (67, 6)
02-03-2020.csv (68, 6)
02-04-2020.csv (70, 6)
02-05-2020.csv (71, 6)
02-06-2020.csv (71, 6)
02-07-2020.csv (72, 6)
02-08-2020.csv (72, 6)
02-09-2020.csv (72, 6)
02-10-2020.csv (72, 6)
02-11-2020.csv (73, 6)
02-12-2020.csv (73, 6)
02-13-2020.csv (74, 6)
02-14-2020.csv (75, 6)
02-15-2020.csv (75, 6)
02-16-2020.csv (75, 6)
02-17-2020.csv (75, 6)
02-18-2020.csv (75, 6)
02-19-2020.csv (76, 6)
02-20-2020.csv (76, 6)
02-21-2020.csv (84, 6)
02-22-2020.csv (84, 6)
02-23-2020.csv (85, 6)
02-24-2020.csv (90, 6)
02-25-2020.csv (94, 6)
02-26-2020.csv (101, 6)
02-27-2020.csv (105, 6)
02-28-2020.csv (114, 6)
02-29-2020.csv (119, 6)
03-01-2020.csv (125, 8)
03-02-2020.csv (141, 8)
03-03-2020.csv (151, 8)
03-04-2020.csv (160, 8)
03-05-2020.csv (173, 8)
03-06-2020.csv (199, 8)
03-07-2020.csv (225, 8)
03-08-2020.csv (255, 8)
03-09-2020.csv (266, 8)
03-10-2020.csv (206, 8)
03-11-2020.csv (216, 8)
03-12-2020.csv (218, 8)
03-13-2020.csv (230, 8)
03-14-2020.csv (249, 8)
03-15-2020.csv (258, 8)
03-16-2020.csv (272, 8)
03-17-2020.csv (276, 8)
03-18-2020.csv (284, 8)
03-19-2020.csv (292, 8)
03-20-2020.csv (299, 8)
03-21-2020.csv (304, 8)
03-22-2020.csv (3417, 12)
03-23-2020.csv (3413, 12)
03-24-2020.csv (3416, 12)
03-25-2020.csv (3420, 12)
03-26-2020.csv (3421, 12)
03-27-2020.csv (3429, 12)
03-28-2020.csv (3430, 12)
03-29-2020.csv (3434, 12)
03-30-2020.csv (3439, 12)
03-31-2020.csv (2434, 12)
04-01-2020.csv (2483, 12)
04-02-2020.csv (2569, 12)
04-03-2020.csv (2625, 12)
04-04-2020.csv (2679, 12)
04-05-2020.csv (2764, 12)
04-06-2020.csv (2809, 12)
04-07-2020.csv (2857, 12)
04-08-2020.csv (2883, 12)
04-09-2020.csv (2911, 12)
04-10-2020.csv (2942, 12)
04-11-2020.csv (2966, 12)
04-12-2020.csv (2989, 12)
04-13-2020.csv (3002, 12)
04-14-2020.csv (3014, 12)
04-15-2020.csv (3027, 12)</code></pre>
</div>
</div>
<div id="cell-23" class="cell" data-scrolled="true" data-tags="[]" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> <span class="bu">sorted</span>(glob.glob(dataset_path)):</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>       <span class="bu">print</span>(<span class="bu">file</span>.rsplit(os.path.sep,<span class="dv">1</span>)[<span class="dv">1</span>] <span class="co"># isolate file name</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>             , pd.read_csv(<span class="bu">file</span>).shape <span class="co"># calculate data shape (rows, columns)</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>             , os.stat(<span class="bu">file</span>).st_size<span class="op">/</span>(<span class="dv">1024</span><span class="op">*</span><span class="dv">1024</span>)) <span class="co"># get the individual file size in MB</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>01-22-2020.csv (38, 6) 0.0015974044799804688
01-23-2020.csv (46, 6) 0.00174713134765625
01-24-2020.csv (41, 6) 0.0016164779663085938
01-25-2020.csv (44, 6) 0.0017070770263671875
01-26-2020.csv (47, 6) 0.00180816650390625
01-27-2020.csv (51, 6) 0.0019540786743164062
01-28-2020.csv (52, 6) 0.0020046234130859375
01-29-2020.csv (54, 6) 0.00208282470703125
01-30-2020.csv (58, 6) 0.0022258758544921875
01-31-2020.csv (62, 6) 0.0024499893188476562
02-01-2020.csv (67, 6) 0.0026559829711914062
02-02-2020.csv (67, 6) 0.0030050277709960938
02-03-2020.csv (68, 6) 0.0030527114868164062
02-04-2020.csv (70, 6) 0.0031423568725585938
02-05-2020.csv (71, 6) 0.0031862258911132812
02-06-2020.csv (71, 6) 0.0031900405883789062
02-07-2020.csv (72, 6) 0.0032444000244140625
02-08-2020.csv (72, 6) 0.0032510757446289062
02-09-2020.csv (72, 6) 0.0032701492309570312
02-10-2020.csv (72, 6) 0.0032739639282226562
02-11-2020.csv (73, 6) 0.0033283233642578125
02-12-2020.csv (73, 6) 0.0033311843872070312
02-13-2020.csv (74, 6) 0.0033807754516601562
02-14-2020.csv (75, 6) 0.0033416748046875
02-15-2020.csv (75, 6) 0.0033464431762695312
02-16-2020.csv (75, 6) 0.0033473968505859375
02-17-2020.csv (75, 6) 0.0034189224243164062
02-18-2020.csv (75, 6) 0.003421783447265625
02-19-2020.csv (76, 6) 0.0033855438232421875
02-20-2020.csv (76, 6) 0.0033864974975585938
02-21-2020.csv (84, 6) 0.0037584304809570312
02-22-2020.csv (84, 6) 0.0038251876831054688
02-23-2020.csv (85, 6) 0.0038623809814453125
02-24-2020.csv (90, 6) 0.004063606262207031
02-25-2020.csv (94, 6) 0.004210472106933594
02-26-2020.csv (101, 6) 0.004431724548339844
02-27-2020.csv (105, 6) 0.004573822021484375
02-28-2020.csv (114, 6) 0.004901885986328125
02-29-2020.csv (119, 6) 0.0051116943359375
03-01-2020.csv (125, 8) 0.0073528289794921875
03-02-2020.csv (141, 8) 0.008268356323242188
03-03-2020.csv (151, 8) 0.008862495422363281
03-04-2020.csv (160, 8) 0.009377479553222656
03-05-2020.csv (173, 8) 0.010189056396484375
03-06-2020.csv (199, 8) 0.011743545532226562
03-07-2020.csv (225, 8) 0.013422012329101562
03-08-2020.csv (255, 8) 0.015294075012207031
03-09-2020.csv (266, 8) 0.01593017578125
03-10-2020.csv (206, 8) 0.011493682861328125
03-11-2020.csv (216, 8) 0.0117645263671875
03-12-2020.csv (218, 8) 0.011874198913574219
03-13-2020.csv (230, 8) 0.012880325317382812
03-14-2020.csv (249, 8) 0.013600349426269531
03-15-2020.csv (258, 8) 0.014292716979980469
03-16-2020.csv (272, 8) 0.014932632446289062
03-17-2020.csv (276, 8) 0.015168190002441406
03-18-2020.csv (284, 8) 0.015623092651367188
03-19-2020.csv (292, 8) 0.016092300415039062
03-20-2020.csv (299, 8) 0.01649951934814453
03-21-2020.csv (304, 8) 0.016945838928222656
03-22-2020.csv (3417, 12) 0.3128471374511719
03-23-2020.csv (3413, 12) 0.3327207565307617
03-24-2020.csv (3416, 12) 0.3328866958618164
03-25-2020.csv (3420, 12) 0.33330821990966797
03-26-2020.csv (3421, 12) 0.3335227966308594
03-27-2020.csv (3429, 12) 0.334259033203125
03-28-2020.csv (3430, 12) 0.31421375274658203
03-29-2020.csv (3434, 12) 0.3146400451660156
03-30-2020.csv (3439, 12) 0.31514453887939453
03-31-2020.csv (2434, 12) 0.23666667938232422
04-01-2020.csv (2483, 12) 0.24163150787353516
04-02-2020.csv (2569, 12) 0.23265457153320312
04-03-2020.csv (2625, 12) 0.25572681427001953
04-04-2020.csv (2679, 12) 0.2430257797241211
04-05-2020.csv (2764, 12) 0.26952648162841797
04-06-2020.csv (2809, 12) 0.25507640838623047
04-07-2020.csv (2857, 12) 0.2788209915161133
04-08-2020.csv (2883, 12) 0.2814149856567383
04-09-2020.csv (2911, 12) 0.2843132019042969
04-10-2020.csv (2942, 12) 0.2873687744140625
04-11-2020.csv (2966, 12) 0.2899484634399414
04-12-2020.csv (2989, 12) 0.2915000915527344
04-13-2020.csv (3002, 12) 0.2954998016357422
04-14-2020.csv (3014, 12) 0.2967643737792969
04-15-2020.csv (3027, 12) 0.29817771911621094</code></pre>
</div>
</div>
</section>
<section id="whats-the-goal-when-preparing-this-dataset-for-vizualization" class="level1">
<h1>What’s the goal when preparing this dataset for vizualization?</h1>
<p>We are going to use plotly.js to visualize the data, however that means that the data needs to be ‘clean’. Basically, the data needs to be in the format and shape that is required for visualization given that plotly won’t make assumptions about how to draw your data points. I’ve seen some beautifully picassoesque and Dr Seuss-like graphs when working with malformed data.</p>
<p>In this instance we want to create a graph that show’s us the number of COVID cases per country per day, and animate through the days. To do this we will need to have the data in the following format:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Country Name</th>
<th>Country ISO Code</th>
<th>Day</th>
<th>Number of Cases</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Switzerland</td>
<td>CHE</td>
<td>2020-02-29</td>
<td>xxx</td>
</tr>
<tr class="even">
<td>France</td>
<td>FRA</td>
<td>2020-02-29</td>
<td>yyy</td>
</tr>
<tr class="odd">
<td>Switzerland</td>
<td>CHE</td>
<td>2020-03-01</td>
<td>zzz</td>
</tr>
<tr class="even">
<td>France</td>
<td>FRA</td>
<td>2020-03-01</td>
<td>aaa</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
<p>To get to that format we’ll have to go from whichever format we have in the chosen data set to the format above. To be able to do that we’ll need to load and harmonize the daily reports with the following steps:</p>
<ol type="1">
<li>Load the data into memory</li>
<li>Analyze the dataset and make decisions about what to do</li>
<li>Consolidate data which has changed names over time</li>
<li>Clean up the country names to identify the ISO codes for countries</li>
<li>Visualize the data on a world map</li>
<li>Tweak the visualization</li>
<li>Adapt our visualization to look at cases per 100k instead of number of cases</li>
</ol>
<section id="load-the-data-set-into-a-pandas-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="load-the-data-set-into-a-pandas-dataframe">1. Load the data set into a pandas dataframe</h2>
<p>Load all the data into memory and see how we can combine the data into a single set for us to use with data visualization.</p>
<div id="cell-27" class="cell" data-scrolled="true" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> glob </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two lists to store our file metadata and file data</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>all_data <span class="op">=</span> []</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>meta_data <span class="op">=</span> []</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For every file in our data set path</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> <span class="bu">sorted</span>(glob.glob(dataset_path)):</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. Read the file to a temporary data frame</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.read_csv(<span class="bu">file</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. Append a dictionary with the file meta_data into the metadata list</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    meta_data.append( {  <span class="st">'file_name'</span>: <span class="bu">file</span>.rsplit(os.path.sep,<span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>                       , <span class="st">'num_rows'</span>: df.shape[<span class="dv">0</span>]</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>                       , <span class="st">'num_cols'</span>: df.shape[<span class="dv">1</span>]</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                       , <span class="st">'col_names'</span>: <span class="st">'</span><span class="ch">\t</span><span class="st">'</span>.join(<span class="bu">sorted</span>(<span class="bu">list</span>(df.columns)))} )</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add the file name to the loaded data</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'source_file'</span>] <span class="op">=</span> <span class="bu">file</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 4. Add the loaded data with the file name to a list with all the loaded data</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    all_data.append(df)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Create a table/dataframe out of our meta_data </span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>meta_data <span class="op">=</span> pd.DataFrame(meta_data)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co"># show the metadata in jupyter notebook</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>meta_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">file_name</th>
<th data-quarto-table-cell-role="th">num_rows</th>
<th data-quarto-table-cell-role="th">num_cols</th>
<th data-quarto-table-cell-role="th">col_names</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>01-22-2020.csv</td>
<td>38</td>
<td>6</td>
<td>Confirmed\tCountry/Region\tDeaths\tLast Update...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>01-23-2020.csv</td>
<td>46</td>
<td>6</td>
<td>Confirmed\tCountry/Region\tDeaths\tLast Update...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>01-24-2020.csv</td>
<td>41</td>
<td>6</td>
<td>Confirmed\tCountry/Region\tDeaths\tLast Update...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>01-25-2020.csv</td>
<td>44</td>
<td>6</td>
<td>Confirmed\tCountry/Region\tDeaths\tLast Update...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>01-26-2020.csv</td>
<td>47</td>
<td>6</td>
<td>Confirmed\tCountry/Region\tDeaths\tLast Update...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">80</td>
<td>04-11-2020.csv</td>
<td>2966</td>
<td>12</td>
<td>Active\tAdmin2\tCombined_Key\tConfirmed\tCount...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">81</td>
<td>04-12-2020.csv</td>
<td>2989</td>
<td>12</td>
<td>Active\tAdmin2\tCombined_Key\tConfirmed\tCount...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">82</td>
<td>04-13-2020.csv</td>
<td>3002</td>
<td>12</td>
<td>Active\tAdmin2\tCombined_Key\tConfirmed\tCount...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83</td>
<td>04-14-2020.csv</td>
<td>3014</td>
<td>12</td>
<td>Active\tAdmin2\tCombined_Key\tConfirmed\tCount...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">84</td>
<td>04-15-2020.csv</td>
<td>3027</td>
<td>12</td>
<td>Active\tAdmin2\tCombined_Key\tConfirmed\tCount...</td>
</tr>
</tbody>
</table>

<p>85 rows × 4 columns</p>
</div>
</div>
</div>
<div id="cell-28" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'max_colwidth'</span>, <span class="dv">150</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># output result to notebook window</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>meta_data.groupby([<span class="st">'num_cols'</span>])<span class="op">\</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>         .agg({ <span class="st">'num_rows'</span>: <span class="st">'sum'</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>              , <span class="st">'file_name'</span>: <span class="bu">sorted</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>              , <span class="st">'col_names'</span>: <span class="bu">set</span> })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">num_rows</th>
<th data-quarto-table-cell-role="th">file_name</th>
<th data-quarto-table-cell-role="th">col_names</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">num_cols</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2818</td>
<td>[01-22-2020.csv, 01-23-2020.csv, 01-24-2020.csv, 01-25-2020.csv, 01-26-2020.csv, 01-27-2020.csv, 01-28-2020.csv, 01-29-2020.csv, 01-30-2020.csv, 0...</td>
<td>{Confirmed\tCountry/Region\tDeaths\tLast Update\tProvince/State\tRecovered}</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>4799</td>
<td>[03-01-2020.csv, 03-02-2020.csv, 03-03-2020.csv, 03-04-2020.csv, 03-05-2020.csv, 03-06-2020.csv, 03-07-2020.csv, 03-08-2020.csv, 03-09-2020.csv, 0...</td>
<td>{Confirmed\tCountry/Region\tDeaths\tLast Update\tLatitude\tLongitude\tProvince/State\tRecovered}</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>75773</td>
<td>[03-22-2020.csv, 03-23-2020.csv, 03-24-2020.csv, 03-25-2020.csv, 03-26-2020.csv, 03-27-2020.csv, 03-28-2020.csv, 03-29-2020.csv, 03-30-2020.csv, 0...</td>
<td>{Active\tAdmin2\tCombined_Key\tConfirmed\tCountry_Region\tDeaths\tFIPS\tLast_Update\tLat\tLong_\tProvince_State\tRecovered}</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-29" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>d_data <span class="op">=</span> pd.concat(all_data</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                  , axis<span class="op">=</span><span class="st">'index'</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                  , join<span class="op">=</span><span class="st">'outer'</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                  , ignore_index<span class="op">=</span><span class="va">True</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                  , sort<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>d_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Active</th>
<th data-quarto-table-cell-role="th">Admin2</th>
<th data-quarto-table-cell-role="th">Combined_Key</th>
<th data-quarto-table-cell-role="th">Confirmed</th>
<th data-quarto-table-cell-role="th">Country/Region</th>
<th data-quarto-table-cell-role="th">Country_Region</th>
<th data-quarto-table-cell-role="th">Deaths</th>
<th data-quarto-table-cell-role="th">FIPS</th>
<th data-quarto-table-cell-role="th">Last Update</th>
<th data-quarto-table-cell-role="th">Last_Update</th>
<th data-quarto-table-cell-role="th">Lat</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Long_</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">Province/State</th>
<th data-quarto-table-cell-role="th">Province_State</th>
<th data-quarto-table-cell-role="th">Recovered</th>
<th data-quarto-table-cell-role="th">source_file</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Anhui</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>14.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Beijing</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>6.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Chongqing</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Fujian</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Gansu</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="analyze-the-data-set" class="level1">
<h1>2. Analyze the data set</h1>
<div id="cell-31" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pr <span class="op">=</span> ProfileReport(d_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-32" class="cell" data-tags="[]" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>pr.to_widgets()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Summarize dataset: 100%|██████████| 32/32 [00:19&lt;00:00,  1.68it/s, Completed]
Generate report structure: 100%|██████████| 1/1 [00:03&lt;00:00,  3.54s/it]
Render widgets:   0%|          | 0/1 [00:00&lt;?, ?it/s]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Active</th>
<th data-quarto-table-cell-role="th">Admin2</th>
<th data-quarto-table-cell-role="th">Combined_Key</th>
<th data-quarto-table-cell-role="th">Confirmed</th>
<th data-quarto-table-cell-role="th">Country/Region</th>
<th data-quarto-table-cell-role="th">Country_Region</th>
<th data-quarto-table-cell-role="th">Deaths</th>
<th data-quarto-table-cell-role="th">FIPS</th>
<th data-quarto-table-cell-role="th">Last Update</th>
<th data-quarto-table-cell-role="th">Last_Update</th>
<th data-quarto-table-cell-role="th">Lat</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Long_</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">Province/State</th>
<th data-quarto-table-cell-role="th">Province_State</th>
<th data-quarto-table-cell-role="th">Recovered</th>
<th data-quarto-table-cell-role="th">source_file</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Anhui</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>14.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Beijing</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>6.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Chongqing</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Fujian</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Gansu</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>26.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Guangdong</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Guangxi</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Guizhou</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>4.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Hainan</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Hebei</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Active</th>
<th data-quarto-table-cell-role="th">Admin2</th>
<th data-quarto-table-cell-role="th">Combined_Key</th>
<th data-quarto-table-cell-role="th">Confirmed</th>
<th data-quarto-table-cell-role="th">Country/Region</th>
<th data-quarto-table-cell-role="th">Country_Region</th>
<th data-quarto-table-cell-role="th">Deaths</th>
<th data-quarto-table-cell-role="th">FIPS</th>
<th data-quarto-table-cell-role="th">Last Update</th>
<th data-quarto-table-cell-role="th">Last_Update</th>
<th data-quarto-table-cell-role="th">Lat</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Long_</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">Province/State</th>
<th data-quarto-table-cell-role="th">Province_State</th>
<th data-quarto-table-cell-role="th">Recovered</th>
<th data-quarto-table-cell-role="th">source_file</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">83380</td>
<td>85608.0</td>
<td>NaN</td>
<td>United Kingdom</td>
<td>98476.0</td>
<td>NaN</td>
<td>United Kingdom</td>
<td>12868.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-04-15 22:56:32</td>
<td>55.378100</td>
<td>NaN</td>
<td>-3.436000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83381</td>
<td>224.0</td>
<td>NaN</td>
<td>Uruguay</td>
<td>492.0</td>
<td>NaN</td>
<td>Uruguay</td>
<td>8.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-04-15 22:56:32</td>
<td>-32.522800</td>
<td>NaN</td>
<td>-55.765800</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>260.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">83382</td>
<td>1191.0</td>
<td>NaN</td>
<td>Uzbekistan</td>
<td>1302.0</td>
<td>NaN</td>
<td>Uzbekistan</td>
<td>4.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-04-15 22:56:32</td>
<td>41.377491</td>
<td>NaN</td>
<td>64.585262</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>107.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83383</td>
<td>77.0</td>
<td>NaN</td>
<td>Venezuela</td>
<td>197.0</td>
<td>NaN</td>
<td>Venezuela</td>
<td>9.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-04-15 22:56:32</td>
<td>6.423800</td>
<td>NaN</td>
<td>-66.589700</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>111.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">83384</td>
<td>96.0</td>
<td>NaN</td>
<td>Vietnam</td>
<td>267.0</td>
<td>NaN</td>
<td>Vietnam</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-04-15 22:56:32</td>
<td>14.058324</td>
<td>NaN</td>
<td>108.277199</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>171.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83385</td>
<td>309.0</td>
<td>NaN</td>
<td>West Bank and Gaza</td>
<td>374.0</td>
<td>NaN</td>
<td>West Bank and Gaza</td>
<td>2.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-04-15 22:56:32</td>
<td>31.952200</td>
<td>NaN</td>
<td>35.233200</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>63.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">83386</td>
<td>6.0</td>
<td>NaN</td>
<td>Western Sahara</td>
<td>6.0</td>
<td>NaN</td>
<td>Western Sahara</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-04-15 22:56:32</td>
<td>24.215500</td>
<td>NaN</td>
<td>-12.885800</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83387</td>
<td>1.0</td>
<td>NaN</td>
<td>Yemen</td>
<td>1.0</td>
<td>NaN</td>
<td>Yemen</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-04-15 22:56:32</td>
<td>15.552727</td>
<td>NaN</td>
<td>48.516388</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">83388</td>
<td>16.0</td>
<td>NaN</td>
<td>Zambia</td>
<td>48.0</td>
<td>NaN</td>
<td>Zambia</td>
<td>2.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-04-15 22:56:32</td>
<td>-13.133897</td>
<td>NaN</td>
<td>27.849332</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>30.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83389</td>
<td>19.0</td>
<td>NaN</td>
<td>Zimbabwe</td>
<td>23.0</td>
<td>NaN</td>
<td>Zimbabwe</td>
<td>3.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-04-15 22:56:32</td>
<td>-19.015438</td>
<td>NaN</td>
<td>29.154857</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Render widgets: 100%|██████████| 1/1 [00:13&lt;00:00, 13.76s/it]</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"4af03758334947efb70888a686282a44","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
</section>
<section id="consolidate-data-whose-names-may-have-changed-over-time" class="level1">
<h1>3. Consolidate data whose names may have changed over time</h1>
<p>Some of the data columns we looked at ealier looked like they were renamed, let’s verify that for each pair and then merge the columns.</p>
<div id="cell-34" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>d_data[ </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    (<span class="op">~</span>pd.isnull(d_data[<span class="st">'Country/Region'</span>])) <span class="co"># select rows where Country/Region is null</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>   <span class="op">&amp;</span>                                       <span class="co"># AND</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    (<span class="op">~</span>pd.isnull(d_data[<span class="st">'Country_Region'</span>])) <span class="co"># select rows where Country_Region is null</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># we want to see no rows from this query.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Active</th>
<th data-quarto-table-cell-role="th">Admin2</th>
<th data-quarto-table-cell-role="th">Combined_Key</th>
<th data-quarto-table-cell-role="th">Confirmed</th>
<th data-quarto-table-cell-role="th">Country/Region</th>
<th data-quarto-table-cell-role="th">Country_Region</th>
<th data-quarto-table-cell-role="th">Deaths</th>
<th data-quarto-table-cell-role="th">FIPS</th>
<th data-quarto-table-cell-role="th">Last Update</th>
<th data-quarto-table-cell-role="th">Last_Update</th>
<th data-quarto-table-cell-role="th">Lat</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Long_</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">Province/State</th>
<th data-quarto-table-cell-role="th">Province_State</th>
<th data-quarto-table-cell-role="th">Recovered</th>
<th data-quarto-table-cell-role="th">source_file</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

</div>
</div>
</div>
<p>Now that we’ve confirmed that we can merge the columns we can perform the merge operation</p>
<div id="cell-36" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>d_data[<span class="st">'Country'</span>] <span class="op">=</span> d_data[<span class="st">'Country/Region'</span>].fillna(d_data[<span class="st">'Country_Region'</span>]) </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">#          ↑                      ↑                              ↑           </span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     3. Add to       2. put it here if its null            1. take this     </span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     newcolumn  </span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>d_data[<span class="st">'Country/Region'</span>].fillna(d_data[<span class="st">'Country_Region'</span>]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>0            Mainland China
1            Mainland China
2            Mainland China
3            Mainland China
4            Mainland China
                ...        
83385    West Bank and Gaza
83386        Western Sahara
83387                 Yemen
83388                Zambia
83389              Zimbabwe
Name: Country/Region, Length: 83390, dtype: object</code></pre>
</div>
</div>
<p>This worked well for the first column pair let’s do it for the others. We’ll automate the check that makes sure the columns don’t overlap and will stop execution if the columns overlap.</p>
<div id="cell-38" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(d_data[ </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    (<span class="op">~</span>pd.isnull(d_data[<span class="st">'Province/State'</span>]))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>   <span class="op">&amp;</span>(<span class="op">~</span>pd.isnull(d_data[<span class="st">'Province_State'</span>])) </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    ]) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">'Columns overlap, further investigation is needed.'</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co">#--yes</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>d_data[<span class="st">'ps'</span>] <span class="op">=</span> d_data[<span class="st">'Province/State'</span>].fillna(d_data[<span class="st">'Province_State'</span>])</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co">#          ↑                    ↑                            ↑           </span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     3. Add to     2. put it here if its null          1. take this     </span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     newcolumn  </span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>d_data[<span class="st">'Province/State'</span>].fillna(d_data[<span class="st">'Province_State'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>0            Anhui
1          Beijing
2        Chongqing
3           Fujian
4            Gansu
           ...    
83385          NaN
83386          NaN
83387          NaN
83388          NaN
83389          NaN
Name: Province/State, Length: 83390, dtype: object</code></pre>
</div>
</div>
<div id="cell-39" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(d_data[ </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    (<span class="op">~</span>pd.isnull(d_data[<span class="st">'Long_'</span>]))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>   <span class="op">&amp;</span>(<span class="op">~</span>pd.isnull(d_data[<span class="st">'Longitude'</span>])) </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    ]) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">'Columns overlap, further investigation is needed.'</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">#--yes</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>d_data[<span class="st">'long_val'</span>] <span class="op">=</span> d_data[<span class="st">'Long_'</span>].fillna(d_data[<span class="st">'Longitude'</span>])</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co">#          ↑                   ↑                         ↑           </span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     3. Add to    2. put it here if its null       1. take this     </span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     newcolumn  </span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>d_data[<span class="st">'Long_'</span>].fillna(d_data[<span class="st">'Longitude'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>0              NaN
1              NaN
2              NaN
3              NaN
4              NaN
           ...    
83385    35.233200
83386   -12.885800
83387    48.516388
83388    27.849332
83389    29.154857
Name: Long_, Length: 83390, dtype: float64</code></pre>
</div>
</div>
<div id="cell-40" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(d_data[ </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    (<span class="op">~</span>pd.isnull(d_data[<span class="st">'Lat'</span>]))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>   <span class="op">&amp;</span>(<span class="op">~</span>pd.isnull(d_data[<span class="st">'Latitude'</span>])) </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    ]) <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">'Columns overlap, further investigation is needed.'</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">#--yes</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>d_data[<span class="st">'lat_val'</span>] <span class="op">=</span> d_data[<span class="st">'Lat'</span>].fillna(d_data[<span class="st">'Latitude'</span>])</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co">#          ↑                   ↑                         ↑           </span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     3. Add to    2. put it here if its null       1. take this     </span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     newcolumn  </span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>d_data[<span class="st">'Lat'</span>].fillna(d_data[<span class="st">'Latitude'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>0              NaN
1              NaN
2              NaN
3              NaN
4              NaN
           ...    
83385    31.952200
83386    24.215500
83387    15.552727
83388   -13.133897
83389   -19.015438
Name: Lat, Length: 83390, dtype: float64</code></pre>
</div>
</div>
<div id="cell-41" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">len</span>(d_data[ </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    (<span class="op">~</span>pd.isnull(d_data[<span class="st">'Last Update'</span>]))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>   <span class="op">&amp;</span>(<span class="op">~</span>pd.isnull(d_data[<span class="st">'Last_Update'</span>])) </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    ]) <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">'Columns overlap, further investigation is needed.'</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co">#--yes</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>d_data[<span class="st">'updated_on'</span>] <span class="op">=</span> d_data[<span class="st">'Last Update'</span>].fillna(d_data[<span class="st">'Last_Update'</span>]) </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co">#          ↑                         ↑                            ↑           </span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     3. Add to          2. put it here if its null          1. take this   </span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>d_data[<span class="st">'Last Update'</span>].fillna(d_data[<span class="st">'Last_Update'</span>]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>0            1/22/2020 17:00
1            1/22/2020 17:00
2            1/22/2020 17:00
3            1/22/2020 17:00
4            1/22/2020 17:00
                ...         
83385    2020-04-15 22:56:32
83386    2020-04-15 22:56:32
83387    2020-04-15 22:56:32
83388    2020-04-15 22:56:32
83389    2020-04-15 22:56:32
Name: Last Update, Length: 83390, dtype: object</code></pre>
</div>
</div>
<p>With the columns merged, we can drop the old columns as they are no longer needed.</p>
<div id="cell-43" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>d_data.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>Index(['Active', 'Admin2', 'Combined_Key', 'Confirmed', 'Country/Region',
       'Country_Region', 'Deaths', 'FIPS', 'Last Update', 'Last_Update', 'Lat',
       'Latitude', 'Long_', 'Longitude', 'Province/State', 'Province_State',
       'Recovered', 'source_file', 'Country', 'ps', 'long_val', 'lat_val',
       'updated_on'],
      dtype='object')</code></pre>
</div>
</div>
<div id="cell-44" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>d_data.drop(columns<span class="op">=</span>[<span class="st">'Active'</span>, <span class="st">'Admin2'</span>, <span class="st">'Combined_Key'</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                     , <span class="st">'Country/Region'</span>, <span class="st">'Country_Region'</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                     , <span class="st">'Last Update'</span>, <span class="st">'Last_Update'</span>, <span class="st">'Lat'</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                     , <span class="st">'Latitude'</span>, <span class="st">'Long_'</span>, <span class="st">'Longitude'</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                     , <span class="st">'Province/State'</span>, <span class="st">'Province_State'</span>]</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>            , inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In order to work with the data later on, let’s convert the updated_on column to date types from strings so that we can sort and group it properly.</p>
<div id="cell-46" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert updated time to a datetime object to work with</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>d_data[<span class="st">'updated_on'</span>] <span class="op">=</span> pd.to_datetime(d_data[<span class="st">'updated_on'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="clean-up-the-country-names-to-identify-the-iso-codes-for-countries" class="level1">
<h1>4. Clean up the country names to identify the ISO codes for countries</h1>
<p>In order to add data onto the map we need to have the ISO codes for all the countries. To do that we can use the pycountry library we installed at the beginning of the course. Let’s first see if there will be any issues by looking at the country data.</p>
<div id="cell-48" class="cell" data-scrolled="true" data-execution_count="27">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>(d_data[<span class="st">'Country'</span>].unique())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>{' Azerbaijan',
 'Afghanistan',
 'Albania',
 'Algeria',
 'Andorra',
 'Angola',
 'Antigua and Barbuda',
 'Argentina',
 'Armenia',
 'Aruba',
 'Australia',
 'Austria',
 'Azerbaijan',
 'Bahamas',
 'Bahamas, The',
 'Bahrain',
 'Bangladesh',
 'Barbados',
 'Belarus',
 'Belgium',
 'Belize',
 'Benin',
 'Bhutan',
 'Bolivia',
 'Bosnia and Herzegovina',
 'Botswana',
 'Brazil',
 'Brunei',
 'Bulgaria',
 'Burkina Faso',
 'Burma',
 'Burundi',
 'Cabo Verde',
 'Cambodia',
 'Cameroon',
 'Canada',
 'Cape Verde',
 'Cayman Islands',
 'Central African Republic',
 'Chad',
 'Channel Islands',
 'Chile',
 'China',
 'Colombia',
 'Congo (Brazzaville)',
 'Congo (Kinshasa)',
 'Costa Rica',
 "Cote d'Ivoire",
 'Croatia',
 'Cruise Ship',
 'Cuba',
 'Curacao',
 'Cyprus',
 'Czech Republic',
 'Czechia',
 'Denmark',
 'Diamond Princess',
 'Djibouti',
 'Dominica',
 'Dominican Republic',
 'East Timor',
 'Ecuador',
 'Egypt',
 'El Salvador',
 'Equatorial Guinea',
 'Eritrea',
 'Estonia',
 'Eswatini',
 'Ethiopia',
 'Faroe Islands',
 'Fiji',
 'Finland',
 'France',
 'French Guiana',
 'Gabon',
 'Gambia',
 'Gambia, The',
 'Georgia',
 'Germany',
 'Ghana',
 'Gibraltar',
 'Greece',
 'Greenland',
 'Grenada',
 'Guadeloupe',
 'Guam',
 'Guatemala',
 'Guernsey',
 'Guinea',
 'Guinea-Bissau',
 'Guyana',
 'Haiti',
 'Holy See',
 'Honduras',
 'Hong Kong',
 'Hong Kong SAR',
 'Hungary',
 'Iceland',
 'India',
 'Indonesia',
 'Iran',
 'Iran (Islamic Republic of)',
 'Iraq',
 'Ireland',
 'Israel',
 'Italy',
 'Ivory Coast',
 'Jamaica',
 'Japan',
 'Jersey',
 'Jordan',
 'Kazakhstan',
 'Kenya',
 'Korea, South',
 'Kosovo',
 'Kuwait',
 'Kyrgyzstan',
 'Laos',
 'Latvia',
 'Lebanon',
 'Liberia',
 'Libya',
 'Liechtenstein',
 'Lithuania',
 'Luxembourg',
 'MS Zaandam',
 'Macao SAR',
 'Macau',
 'Madagascar',
 'Mainland China',
 'Malawi',
 'Malaysia',
 'Maldives',
 'Mali',
 'Malta',
 'Martinique',
 'Mauritania',
 'Mauritius',
 'Mayotte',
 'Mexico',
 'Moldova',
 'Monaco',
 'Mongolia',
 'Montenegro',
 'Morocco',
 'Mozambique',
 'Namibia',
 'Nepal',
 'Netherlands',
 'New Zealand',
 'Nicaragua',
 'Niger',
 'Nigeria',
 'North Ireland',
 'North Macedonia',
 'Norway',
 'Oman',
 'Others',
 'Pakistan',
 'Palestine',
 'Panama',
 'Papua New Guinea',
 'Paraguay',
 'Peru',
 'Philippines',
 'Poland',
 'Portugal',
 'Puerto Rico',
 'Qatar',
 'Republic of Ireland',
 'Republic of Korea',
 'Republic of Moldova',
 'Republic of the Congo',
 'Reunion',
 'Romania',
 'Russia',
 'Russian Federation',
 'Rwanda',
 'Saint Barthelemy',
 'Saint Kitts and Nevis',
 'Saint Lucia',
 'Saint Martin',
 'Saint Vincent and the Grenadines',
 'San Marino',
 'Sao Tome and Principe',
 'Saudi Arabia',
 'Senegal',
 'Serbia',
 'Seychelles',
 'Sierra Leone',
 'Singapore',
 'Slovakia',
 'Slovenia',
 'Somalia',
 'South Africa',
 'South Korea',
 'South Sudan',
 'Spain',
 'Sri Lanka',
 'St. Martin',
 'Sudan',
 'Suriname',
 'Sweden',
 'Switzerland',
 'Syria',
 'Taipei and environs',
 'Taiwan',
 'Taiwan*',
 'Tanzania',
 'Thailand',
 'The Bahamas',
 'The Gambia',
 'Timor-Leste',
 'Togo',
 'Trinidad and Tobago',
 'Tunisia',
 'Turkey',
 'UK',
 'US',
 'Uganda',
 'Ukraine',
 'United Arab Emirates',
 'United Kingdom',
 'Uruguay',
 'Uzbekistan',
 'Vatican City',
 'Venezuela',
 'Viet Nam',
 'Vietnam',
 'West Bank and Gaza',
 'Western Sahara',
 'Yemen',
 'Zambia',
 'Zimbabwe',
 'occupied Palestinian territory'}</code></pre>
</div>
</div>
<div id="cell-49" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pycountry</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Mainland China'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">'China'</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Macau'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">'China'</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'South Korea'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">'Republic of Korea'</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Korea, South'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">'Republic of Korea'</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Ivory Coast'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"Republic of Cote d'Ivoire"</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'North Ireland'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"United Kingdom"</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Republic of Ireland'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"Ireland"</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'St. Martin'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"France"</span> </span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Iran (Islamic Republic of)'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"Iran"</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'West Bank and Gaza'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"Palestine"</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Channel Islands'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"UK"</span> <span class="co">## Not technically, but effectively, great tax laws</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>].isin([ <span class="st">'Congo (Brazzaville)'</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>                                    ,<span class="st">'Congo (Kinshasa)'</span>]), <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">'Congo'</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Gambia, The'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"Gambia"</span> </span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Bahamas, The'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"Bahamas"</span> </span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Cape Verde'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">'Republic of Cabo Verde'</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'East Timor'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">'Timor-Leste'</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Laos'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"Lao People's Democratic Republic"</span> </span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>d_data.loc[ d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">"Burma"</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">'Myanmar'</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a><span class="co"># dropping disputed teritories and not teritories</span></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>d_data <span class="op">=</span> d_data.drop(d_data[d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Others'</span>].index)</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>d_data <span class="op">=</span> d_data.drop(d_data[d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Taipei and environs'</span>].index)</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>d_data <span class="op">=</span> d_data.drop(d_data[d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'occupied Palestinian territory'</span>].index) </span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>d_data <span class="op">=</span> d_data.drop(d_data[d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Taiwan*'</span>].index)</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>d_data <span class="op">=</span> d_data.drop(d_data[d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Taiwan'</span>].index)</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>d_data <span class="op">=</span> d_data.drop(d_data[d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'MS Zaandam'</span>].index)</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>d_data <span class="op">=</span> d_data.drop(d_data[d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Cruise Ship'</span>].index)</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>d_data <span class="op">=</span> d_data.drop(d_data[d_data[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Diamond Princess'</span>].index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-50" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>countries <span class="op">=</span> pd.Series(d_data[<span class="st">'Country'</span>].unique())</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_iso(country_name):</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">'Country'</span>:country_name, <span class="st">'ISO_3'</span>: pycountry.countries.search_fuzzy(country_name)[<span class="dv">0</span>].alpha_3}</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>countries <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(countries.<span class="bu">map</span>(get_iso)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-51" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>d_data.merge(countries</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>            , on<span class="op">=</span><span class="st">'Country'</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>            , how<span class="op">=</span><span class="st">'inner'</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>            , validate<span class="op">=</span><span class="st">'m:1'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Confirmed</th>
<th data-quarto-table-cell-role="th">Deaths</th>
<th data-quarto-table-cell-role="th">FIPS</th>
<th data-quarto-table-cell-role="th">Recovered</th>
<th data-quarto-table-cell-role="th">source_file</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">ps</th>
<th data-quarto-table-cell-role="th">long_val</th>
<th data-quarto-table-cell-role="th">lat_val</th>
<th data-quarto-table-cell-role="th">updated_on</th>
<th data-quarto-table-cell-role="th">ISO_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
<td>China</td>
<td>Anhui</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-01-22 17:00:00</td>
<td>CHN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>14.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
<td>China</td>
<td>Beijing</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-01-22 17:00:00</td>
<td>CHN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>6.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
<td>China</td>
<td>Chongqing</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-01-22 17:00:00</td>
<td>CHN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
<td>China</td>
<td>Fujian</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-01-22 17:00:00</td>
<td>CHN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
<td>China</td>
<td>Gansu</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-01-22 17:00:00</td>
<td>CHN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">83206</td>
<td>1.0</td>
<td>0.0</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-11-2020.csv</td>
<td>Yemen</td>
<td>NaN</td>
<td>48.516388</td>
<td>15.552727</td>
<td>2020-04-11 22:45:13</td>
<td>YEM</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83207</td>
<td>1.0</td>
<td>0.0</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-12-2020.csv</td>
<td>Yemen</td>
<td>NaN</td>
<td>48.516388</td>
<td>15.552727</td>
<td>2020-04-12 23:17:00</td>
<td>YEM</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">83208</td>
<td>1.0</td>
<td>0.0</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-13-2020.csv</td>
<td>Yemen</td>
<td>NaN</td>
<td>48.516388</td>
<td>15.552727</td>
<td>2020-04-13 23:07:34</td>
<td>YEM</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83209</td>
<td>1.0</td>
<td>0.0</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-14-2020.csv</td>
<td>Yemen</td>
<td>NaN</td>
<td>48.516388</td>
<td>15.552727</td>
<td>2020-04-14 23:33:12</td>
<td>YEM</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">83210</td>
<td>1.0</td>
<td>0.0</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv</td>
<td>Yemen</td>
<td>NaN</td>
<td>48.516388</td>
<td>15.552727</td>
<td>2020-04-15 22:56:32</td>
<td>YEM</td>
</tr>
</tbody>
</table>

<p>83211 rows × 11 columns</p>
</div>
</div>
</div>
<div id="cell-52" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>d_data <span class="op">=\</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    d_data.merge(countries</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                , on<span class="op">=</span><span class="st">'Country'</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                , how<span class="op">=</span><span class="st">'inner'</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                , validate<span class="op">=</span><span class="st">'m:1'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="a.-identify-and-fix-issues-with-the-last-reported-data-column-for-our-grouping-purposes" class="level3">
<h3 class="anchored" data-anchor-id="a.-identify-and-fix-issues-with-the-last-reported-data-column-for-our-grouping-purposes">4. a. identify and fix issues with the last-reported data column for our grouping purposes</h3>
<div id="cell-54" class="cell" data-scrolled="true" data-execution_count="32">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">"display.max_rows"</span>, <span class="dv">300</span>) <span class="co"># increase the number of rows visible </span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>d_data[d_data[<span class="st">'ISO_3'</span>] <span class="op">==</span> <span class="st">'DEU'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Confirmed</th>
<th data-quarto-table-cell-role="th">Deaths</th>
<th data-quarto-table-cell-role="th">FIPS</th>
<th data-quarto-table-cell-role="th">Recovered</th>
<th data-quarto-table-cell-role="th">source_file</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">ps</th>
<th data-quarto-table-cell-role="th">long_val</th>
<th data-quarto-table-cell-role="th">lat_val</th>
<th data-quarto-table-cell-role="th">updated_on</th>
<th data-quarto-table-cell-role="th">ISO_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">76227</td>
<td>4.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-28-2020.csv</td>
<td>Germany</td>
<td>Bavaria</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-01-28 23:00:00</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76228</td>
<td>4.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-29-2020.csv</td>
<td>Germany</td>
<td>Bavaria</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-01-29 19:30:00</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76229</td>
<td>4.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-30-2020.csv</td>
<td>Germany</td>
<td>Bavaria</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-01-30 16:00:00</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76230</td>
<td>5.0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-31-2020.csv</td>
<td>Germany</td>
<td>Bavaria</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-01-31 23:59:00</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76231</td>
<td>8.0</td>
<td>0.0</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-01-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-01 18:33:00</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76232</td>
<td>10.0</td>
<td>0.0</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-02-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-02 18:03:05</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76233</td>
<td>12.0</td>
<td>0.0</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-03-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-03 20:53:02</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76234</td>
<td>12.0</td>
<td>0.0</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-04-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-03 20:53:02</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76235</td>
<td>12.0</td>
<td>0.0</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-05-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-03 20:53:02</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76236</td>
<td>12.0</td>
<td>0.0</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-06-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-03 20:53:02</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76237</td>
<td>13.0</td>
<td>0.0</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-07-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-07 16:33:03</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76238</td>
<td>13.0</td>
<td>0.0</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-08-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-07 16:33:03</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76239</td>
<td>14.0</td>
<td>0.0</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-09-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-09 06:13:11</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76240</td>
<td>14.0</td>
<td>0.0</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-10-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-09 06:13:11</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76241</td>
<td>16.0</td>
<td>0.0</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-11-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-11 19:33:03</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76242</td>
<td>16.0</td>
<td>0.0</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-12-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-11 19:33:03</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76243</td>
<td>16.0</td>
<td>0.0</td>
<td>NaN</td>
<td>1.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-13-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-13 15:13:11</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76244</td>
<td>16.0</td>
<td>0.0</td>
<td>NaN</td>
<td>1.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-14-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-13 15:13:11</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76245</td>
<td>16.0</td>
<td>0.0</td>
<td>NaN</td>
<td>1.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-15-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-13 15:13:11</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76246</td>
<td>16.0</td>
<td>0.0</td>
<td>NaN</td>
<td>1.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-16-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-13 15:13:11</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76247</td>
<td>16.0</td>
<td>0.0</td>
<td>NaN</td>
<td>1.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-17-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-13 15:13:11</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76248</td>
<td>16.0</td>
<td>0.0</td>
<td>NaN</td>
<td>12.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-18-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-18 17:03:03</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76249</td>
<td>16.0</td>
<td>0.0</td>
<td>NaN</td>
<td>12.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-19-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-18 17:03:03</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76250</td>
<td>16.0</td>
<td>0.0</td>
<td>NaN</td>
<td>12.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-20-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-18 17:03:03</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76251</td>
<td>16.0</td>
<td>0.0</td>
<td>NaN</td>
<td>14.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-21-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-21 23:03:13</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76252</td>
<td>16.0</td>
<td>0.0</td>
<td>NaN</td>
<td>14.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-22-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-21 23:03:13</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76253</td>
<td>16.0</td>
<td>0.0</td>
<td>NaN</td>
<td>14.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-23-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-21 23:03:13</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76254</td>
<td>16.0</td>
<td>0.0</td>
<td>NaN</td>
<td>14.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-24-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-21 23:03:13</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76255</td>
<td>17.0</td>
<td>0.0</td>
<td>NaN</td>
<td>14.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-25-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-25 21:33:02</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76256</td>
<td>27.0</td>
<td>0.0</td>
<td>NaN</td>
<td>15.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-26-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-26 23:43:03</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76257</td>
<td>46.0</td>
<td>0.0</td>
<td>NaN</td>
<td>16.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-27-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-27 23:13:04</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76258</td>
<td>48.0</td>
<td>0.0</td>
<td>NaN</td>
<td>16.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-28-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-28 00:13:18</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76259</td>
<td>79.0</td>
<td>0.0</td>
<td>NaN</td>
<td>16.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/02-29-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-02-29 14:43:03</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76260</td>
<td>130.0</td>
<td>0.0</td>
<td>NaN</td>
<td>16.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-01-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>9.000000</td>
<td>51.000000</td>
<td>2020-03-01 23:23:02</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76261</td>
<td>159.0</td>
<td>0.0</td>
<td>NaN</td>
<td>16.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-02-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>9.000000</td>
<td>51.000000</td>
<td>2020-03-02 20:33:02</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76262</td>
<td>196.0</td>
<td>0.0</td>
<td>NaN</td>
<td>16.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-03-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>9.000000</td>
<td>51.000000</td>
<td>2020-03-03 20:03:06</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76263</td>
<td>262.0</td>
<td>0.0</td>
<td>NaN</td>
<td>16.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-04-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>9.000000</td>
<td>51.000000</td>
<td>2020-03-04 19:33:03</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76264</td>
<td>482.0</td>
<td>0.0</td>
<td>NaN</td>
<td>16.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-05-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>9.000000</td>
<td>51.000000</td>
<td>2020-03-05 17:43:03</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76265</td>
<td>670.0</td>
<td>0.0</td>
<td>NaN</td>
<td>17.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-06-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>9.000000</td>
<td>51.000000</td>
<td>2020-03-06 17:53:03</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76266</td>
<td>799.0</td>
<td>0.0</td>
<td>NaN</td>
<td>18.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-07-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>9.000000</td>
<td>51.000000</td>
<td>2020-03-07 17:43:05</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76267</td>
<td>1040.0</td>
<td>0.0</td>
<td>NaN</td>
<td>18.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-08-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>9.000000</td>
<td>51.000000</td>
<td>2020-03-08 21:03:03</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76268</td>
<td>1176.0</td>
<td>2.0</td>
<td>NaN</td>
<td>18.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-09-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>9.000000</td>
<td>51.000000</td>
<td>2020-03-09 18:13:11</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76269</td>
<td>1457.0</td>
<td>2.0</td>
<td>NaN</td>
<td>18.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-10-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>9.000000</td>
<td>51.000000</td>
<td>2020-03-10 18:53:02</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76270</td>
<td>1908.0</td>
<td>3.0</td>
<td>NaN</td>
<td>25.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-11-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>9.000000</td>
<td>51.000000</td>
<td>2020-03-11 19:13:17</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76271</td>
<td>2078.0</td>
<td>3.0</td>
<td>NaN</td>
<td>25.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-12-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>9.000000</td>
<td>51.000000</td>
<td>2020-03-12 09:53:06</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76272</td>
<td>3675.0</td>
<td>7.0</td>
<td>NaN</td>
<td>46.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-13-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451500</td>
<td>51.165700</td>
<td>2020-03-11 20:00:00</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76273</td>
<td>4585.0</td>
<td>9.0</td>
<td>NaN</td>
<td>46.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-14-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451500</td>
<td>51.165700</td>
<td>2020-03-14 22:13:11</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76274</td>
<td>5795.0</td>
<td>11.0</td>
<td>NaN</td>
<td>46.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-15-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451500</td>
<td>51.165700</td>
<td>2020-03-15 18:20:18</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76275</td>
<td>7272.0</td>
<td>17.0</td>
<td>NaN</td>
<td>67.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-16-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451500</td>
<td>51.165700</td>
<td>2020-03-16 20:13:11</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76276</td>
<td>9257.0</td>
<td>24.0</td>
<td>NaN</td>
<td>67.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-17-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451500</td>
<td>51.165700</td>
<td>2020-03-17 18:53:02</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76277</td>
<td>12327.0</td>
<td>28.0</td>
<td>NaN</td>
<td>105.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-18-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451500</td>
<td>51.165700</td>
<td>2020-03-18 19:33:02</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76278</td>
<td>15320.0</td>
<td>44.0</td>
<td>NaN</td>
<td>113.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-19-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451500</td>
<td>51.165700</td>
<td>2020-03-19 20:13:08</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76279</td>
<td>19848.0</td>
<td>67.0</td>
<td>NaN</td>
<td>180.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-20-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451500</td>
<td>51.165700</td>
<td>2020-03-20 20:13:15</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76280</td>
<td>22213.0</td>
<td>84.0</td>
<td>NaN</td>
<td>233.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-21-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451500</td>
<td>51.165700</td>
<td>2020-03-21 20:43:02</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76281</td>
<td>24873.0</td>
<td>94.0</td>
<td>NaN</td>
<td>266.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-22-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-03-22 23:45:00</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76282</td>
<td>29056.0</td>
<td>123.0</td>
<td>NaN</td>
<td>453.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-23-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-03-23 23:19:21</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76283</td>
<td>32986.0</td>
<td>157.0</td>
<td>NaN</td>
<td>3243.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-24-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-03-24 23:37:15</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76284</td>
<td>37323.0</td>
<td>206.0</td>
<td>NaN</td>
<td>3547.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-25-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-03-25 23:33:04</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76285</td>
<td>43938.0</td>
<td>267.0</td>
<td>NaN</td>
<td>5673.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-26-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-03-26 23:48:18</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76286</td>
<td>50871.0</td>
<td>342.0</td>
<td>NaN</td>
<td>6658.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-27-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-03-27 23:23:03</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76287</td>
<td>57695.0</td>
<td>433.0</td>
<td>NaN</td>
<td>8481.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-28-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-03-28 23:05:00</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76288</td>
<td>62095.0</td>
<td>533.0</td>
<td>NaN</td>
<td>9211.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-29-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-03-29 23:08:00</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76289</td>
<td>66885.0</td>
<td>645.0</td>
<td>NaN</td>
<td>13500.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-30-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-03-30 22:52:00</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76290</td>
<td>71808.0</td>
<td>775.0</td>
<td>NaN</td>
<td>16100.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/03-31-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-03-31 23:43:43</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76291</td>
<td>77872.0</td>
<td>920.0</td>
<td>NaN</td>
<td>18700.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-01-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-04-01 21:58:34</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76292</td>
<td>84794.0</td>
<td>1107.0</td>
<td>NaN</td>
<td>22440.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-02-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-04-02 23:25:00</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76293</td>
<td>91159.0</td>
<td>1275.0</td>
<td>NaN</td>
<td>24575.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-03-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-04-03 22:46:20</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76294</td>
<td>96092.0</td>
<td>1444.0</td>
<td>NaN</td>
<td>26400.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-04-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-04-04 23:34:00</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76295</td>
<td>100123.0</td>
<td>1584.0</td>
<td>NaN</td>
<td>28700.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-05-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-04-05 23:06:26</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76296</td>
<td>103374.0</td>
<td>1810.0</td>
<td>NaN</td>
<td>28700.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-06-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-04-06 23:21:00</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76297</td>
<td>107663.0</td>
<td>2016.0</td>
<td>NaN</td>
<td>36081.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-07-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-04-07 23:04:29</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76298</td>
<td>113296.0</td>
<td>2349.0</td>
<td>NaN</td>
<td>46300.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-08-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-04-08 22:51:39</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76299</td>
<td>118181.0</td>
<td>2607.0</td>
<td>NaN</td>
<td>52407.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-09-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-04-09 23:02:19</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76300</td>
<td>122171.0</td>
<td>2767.0</td>
<td>NaN</td>
<td>53913.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-10-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-04-10 22:53:48</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76301</td>
<td>124908.0</td>
<td>2736.0</td>
<td>NaN</td>
<td>57400.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-11-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-04-11 22:45:13</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76302</td>
<td>127854.0</td>
<td>3022.0</td>
<td>NaN</td>
<td>60300.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-12-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-04-12 23:17:00</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76303</td>
<td>130072.0</td>
<td>3194.0</td>
<td>NaN</td>
<td>64300.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-13-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-04-13 23:07:34</td>
<td>DEU</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">76304</td>
<td>131359.0</td>
<td>3294.0</td>
<td>NaN</td>
<td>68200.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-14-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-04-14 23:33:12</td>
<td>DEU</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76305</td>
<td>134753.0</td>
<td>3804.0</td>
<td>NaN</td>
<td>72600.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv</td>
<td>Germany</td>
<td>NaN</td>
<td>10.451526</td>
<td>51.165691</td>
<td>2020-04-15 22:56:32</td>
<td>DEU</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-55" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>d_data[<span class="st">'report_date'</span>] <span class="op">=</span> <span class="op">\</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>     pd.to_datetime( </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>         d_data[<span class="st">'source_file'</span>].astype(<span class="st">'str'</span>)                      <span class="co"># convert the values in the column to string</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                              .<span class="bu">str</span>.rsplit(os.path.sep,<span class="dv">1</span>, expand<span class="op">=</span><span class="va">True</span>)[<span class="dv">1</span>]  <span class="co"># extract the file name from the file path</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                              .<span class="bu">str</span>.replace(<span class="st">'.csv'</span>,<span class="st">''</span>)             <span class="co"># remove the csv extension</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>       , dayfirst<span class="op">=</span><span class="va">False</span>)                                          <span class="co"># convert the newly extracted string to date</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="visualize-the-data-on-a-map" class="level1">
<h1>5. Visualize the data on a map</h1>
<p>To take the data we’ve prepared and put it onto the map we need to sum the number of confirmed cases by the date of the report and the country code.</p>
<div id="cell-57" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>d_data.groupby(by<span class="op">=</span>[<span class="st">'report_date'</span>, <span class="st">'ISO_3'</span>])<span class="op">\</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>      .agg({<span class="st">'Confirmed'</span>: <span class="st">'sum'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Confirmed</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">report_date</th>
<th data-quarto-table-cell-role="th">ISO_3</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">2020-01-22</td>
<td data-quarto-table-cell-role="th">CHN</td>
<td>548.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">HKG</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">JPN</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">PRK</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">THA</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">2020-04-15</td>
<td data-quarto-table-cell-role="th">VNM</td>
<td>267.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">YEM</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZAF</td>
<td>2506.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ZMB</td>
<td>48.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ZWE</td>
<td>23.0</td>
</tr>
</tbody>
</table>

<p>7866 rows × 1 columns</p>
</div>
</div>
</div>
<div id="cell-58" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>viz <span class="op">=</span> <span class="op">\</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>d_data.groupby(by<span class="op">=</span>[<span class="st">'report_date'</span>, <span class="st">'ISO_3'</span>, <span class="st">'Country'</span>])<span class="op">\</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>      .agg({<span class="st">'Confirmed'</span>: <span class="st">'sum'</span>})<span class="op">\</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>      .reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We also need to convert the report date back to string to display it. So let’s convert the report date column to string again.</p>
<div id="cell-60" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>viz[<span class="st">'report_date'</span>] <span class="op">=</span> viz[<span class="st">'report_date'</span>].dt.strftime( <span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-61" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> urllib.request <span class="im">import</span> urlopen</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> urlopen(<span class="st">'https://raw.githubusercontent.com/plotly/datasets/master/geojson-counties-fips.json'</span>) <span class="im">as</span> response:</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    counties <span class="op">=</span> json.load(response)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-62" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>subset <span class="op">=</span> viz[viz[<span class="st">'report_date'</span>] <span class="op">==</span> <span class="st">'2020-04-14'</span>]</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>px.choropleth(subset</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>             , locations<span class="op">=</span><span class="st">'ISO_3'</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>             , locationmode <span class="op">=</span> <span class="st">'ISO-3'</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>             , geojson<span class="op">=</span>counties</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>             , animation_frame<span class="op">=</span><span class="st">'report_date'</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>             , animation_group<span class="op">=</span><span class="st">'ISO_3'</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>             , color<span class="op">=</span><span class="st">'Confirmed'</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>             , color_continuous_scale<span class="op">=</span> <span class="st">'Greens'</span>).write_html(<span class="st">'choropleth_1.html'</span>, full_html<span class="op">=</span><span class="va">False</span>, include_plotlyjs<span class="op">=</span><span class="st">'cdn'</span>)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tweak-the-vizualization" class="level1">
<h1>6. Tweak the vizualization</h1>
<div id="cell-64" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>viz[<span class="st">'sqrt_Confirmed'</span>] <span class="op">=</span> np.sqrt(viz[<span class="st">'Confirmed'</span>].clip(lower<span class="op">=</span><span class="dv">1</span>)) <span class="co"># calculate the square root of the confirmed</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                                                                <span class="co"># cases, clip the columns lower values to at </span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                                                                <span class="co"># least 1.</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> <span class="op">\</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>px.choropleth(viz</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>             , locations<span class="op">=</span><span class="st">'ISO_3'</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>             , locationmode<span class="op">=</span><span class="st">'ISO-3'</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>             , animation_frame<span class="op">=</span><span class="st">'report_date'</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>             , hover_data<span class="op">=</span>[<span class="st">'Confirmed'</span>, <span class="st">'Country'</span>]</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>             , animation_group<span class="op">=</span><span class="st">'ISO_3'</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>             , color<span class="op">=</span><span class="st">'sqrt_Confirmed'</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>             , color_continuous_scale<span class="op">=</span> [[<span class="dv">0</span>,  <span class="st">'rgba(0, 255, 0, .07)'</span> ]</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>                                        ,[<span class="fl">0.5</span>, <span class="st">'green'</span>]</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>                                        ,[<span class="dv">1</span>, <span class="st">'palegreen'</span>]]</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>             , template<span class="op">=</span><span class="st">'plotly_dark'</span>)</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.plotly.v1+json</code></pre>
</div>
</div>
<div id="cell-65" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>fig.show(renderer<span class="op">=</span><span class="st">'browser'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="what-if-we-look-at-the-data-by-proportion-of-the-population" class="level1">
<h1>7. What if we look at the data by proportion of the population?</h1>
<div id="cell-67" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load population data for countries</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>pop_data <span class="op">=</span> px.data.gapminder()</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Select the most recent year available </span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>pop_data <span class="op">=</span> pop_data[pop_data[<span class="st">'year'</span>]<span class="op">==</span><span class="dv">2007</span>]</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Join the population data to our data set based on the country ISO3 code</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>pop_viz <span class="op">=</span>viz.merge(pop_data[[<span class="st">'pop'</span>, <span class="st">'iso_alpha'</span>]]</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>          , left_on<span class="op">=</span><span class="st">'ISO_3'</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>          , right_on<span class="op">=</span><span class="st">'iso_alpha'</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>          , how<span class="op">=</span><span class="st">'left'</span>).dropna()</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the number of cases per 100k population members</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>pop_viz[<span class="st">'proportion'</span>] <span class="op">=</span> (pop_viz[<span class="st">'Confirmed'</span>]<span class="op">/</span>pop_viz[<span class="st">'pop'</span>])<span class="op">*</span><span class="dv">100_000</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>pop_viz[<span class="st">'sqrt_proportion'</span>] <span class="op">=</span> np.sqrt(pop_viz[<span class="st">'proportion'</span>])</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a><span class="co"># map the data </span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>px.choropleth(pop_viz</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>             , locations<span class="op">=</span><span class="st">'ISO_3'</span></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>             , locationmode<span class="op">=</span><span class="st">'ISO-3'</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>             , animation_frame<span class="op">=</span><span class="st">'report_date'</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>             , hover_data<span class="op">=</span>[<span class="st">'Confirmed'</span>, <span class="st">'proportion'</span>, <span class="st">'Country'</span>]</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>             , animation_group<span class="op">=</span><span class="st">'ISO_3'</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>             , color<span class="op">=</span><span class="st">'sqrt_proportion'</span></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>             , color_continuous_scale<span class="op">=</span> [[<span class="dv">0</span>,  <span class="st">'rgba(0, 255, 0, .07)'</span> ]</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>                                        ,[<span class="fl">0.5</span>, <span class="st">'green'</span>]</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>                                        ,[<span class="dv">1</span>, <span class="st">'palegreen'</span>]]</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>             , template<span class="op">=</span><span class="st">'plotly_dark'</span>)<span class="op">\</span></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>.show(renderer<span class="op">=</span><span class="st">'browser'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="extra-problems-to-solve" class="level1">
<h1>8. Extra problems to solve</h1>
<p>After this course you should be armed with some tools to work on other datasets and problems. Here are some additional problems which will stretch your abilities a bit and will require extra reading to solve:</p>
<ol type="1">
<li>Can you rewrite the column merging code into a function so that all you need to do is pass the function, a dataframe, two input column names, and an output column name to have it check if the columns can be merged and merge them?</li>
</ol>
<div class="sourceCode" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> merge_cols(input_df, col1, col2, outcol):</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    ...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="2" type="1">
<li><p>Can you change the way we load the files to avoid needing to merge columns? (hint: you will need to use the pandas rename function <code>dataframe.rename(columns={'from':'to')</code> )</p></li>
<li><p>Can you create a visualization from the timeline dataset? (hint: you will need to use the <code>dataframe.melt()</code> command very rapidly demonstrated in python 101 and you will likley need to do clean up on the countries before doing the ISO_3 lookups)</p></li>
</ol>
</section>
<section id="solution-for-problem-1" class="level1">
<h1>Solution for problem 1</h1>
<div id="cell-70" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> merge_cols(input_df, col1, col2, outcol):</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(input_df[ </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>        (<span class="op">~</span>pd.isnull(input_df[col1]))</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>       <span class="op">&amp;</span>(<span class="op">~</span>pd.isnull(input_df[col2])) </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>        ]) <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">'Columns overlap, further investigation is needed.'</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    input_df[outcol] <span class="op">=</span> input_df[col1].fillna(input_df[col2])</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-71" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>d_data <span class="op">=</span> pd.concat(all_data</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                  , axis<span class="op">=</span><span class="st">'index'</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                  , join<span class="op">=</span><span class="st">'outer'</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                  , ignore_index<span class="op">=</span><span class="va">True</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                  , sort<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>merge_cols(d_data, <span class="st">'Last Update'</span>, <span class="st">'Last_Update'</span>, <span class="st">'updated_on'</span>)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>d_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Active</th>
<th data-quarto-table-cell-role="th">Admin2</th>
<th data-quarto-table-cell-role="th">Combined_Key</th>
<th data-quarto-table-cell-role="th">Confirmed</th>
<th data-quarto-table-cell-role="th">Country/Region</th>
<th data-quarto-table-cell-role="th">Country_Region</th>
<th data-quarto-table-cell-role="th">Deaths</th>
<th data-quarto-table-cell-role="th">FIPS</th>
<th data-quarto-table-cell-role="th">Last Update</th>
<th data-quarto-table-cell-role="th">Last_Update</th>
<th data-quarto-table-cell-role="th">Lat</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Long_</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">Province/State</th>
<th data-quarto-table-cell-role="th">Province_State</th>
<th data-quarto-table-cell-role="th">Recovered</th>
<th data-quarto-table-cell-role="th">source_file</th>
<th data-quarto-table-cell-role="th">updated_on</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Anhui</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
<td>1/22/2020 17:00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>14.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Beijing</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
<td>1/22/2020 17:00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>6.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Chongqing</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
<td>1/22/2020 17:00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Fujian</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
<td>1/22/2020 17:00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Gansu</td>
<td>NaN</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
<td>1/22/2020 17:00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">83385</td>
<td>309.0</td>
<td>NaN</td>
<td>West Bank and Gaza</td>
<td>374.0</td>
<td>NaN</td>
<td>West Bank and Gaza</td>
<td>2.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-04-15 22:56:32</td>
<td>31.952200</td>
<td>NaN</td>
<td>35.233200</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>63.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv</td>
<td>2020-04-15 22:56:32</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83386</td>
<td>6.0</td>
<td>NaN</td>
<td>Western Sahara</td>
<td>6.0</td>
<td>NaN</td>
<td>Western Sahara</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-04-15 22:56:32</td>
<td>24.215500</td>
<td>NaN</td>
<td>-12.885800</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv</td>
<td>2020-04-15 22:56:32</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">83387</td>
<td>1.0</td>
<td>NaN</td>
<td>Yemen</td>
<td>1.0</td>
<td>NaN</td>
<td>Yemen</td>
<td>0.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-04-15 22:56:32</td>
<td>15.552727</td>
<td>NaN</td>
<td>48.516388</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv</td>
<td>2020-04-15 22:56:32</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">83388</td>
<td>16.0</td>
<td>NaN</td>
<td>Zambia</td>
<td>48.0</td>
<td>NaN</td>
<td>Zambia</td>
<td>2.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-04-15 22:56:32</td>
<td>-13.133897</td>
<td>NaN</td>
<td>27.849332</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>30.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv</td>
<td>2020-04-15 22:56:32</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">83389</td>
<td>19.0</td>
<td>NaN</td>
<td>Zimbabwe</td>
<td>23.0</td>
<td>NaN</td>
<td>Zimbabwe</td>
<td>3.0</td>
<td>NaN</td>
<td>NaN</td>
<td>2020-04-15 22:56:32</td>
<td>-19.015438</td>
<td>NaN</td>
<td>29.154857</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/04-15-2020.csv</td>
<td>2020-04-15 22:56:32</td>
</tr>
</tbody>
</table>

<p>83390 rows × 19 columns</p>
</div>
</div>
</div>
</section>
<section id="solution-for-problem-2" class="level1">
<h1>Solution for problem 2</h1>
<div id="cell-73" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>col_pairs <span class="op">=</span> {</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Country/Region'</span>: <span class="st">'Country_Region'</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    ,<span class="st">'Province/State'</span>: <span class="st">'Province_State'</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    ,<span class="st">'Long_'</span>: <span class="st">'Longitude'</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    ,<span class="st">'Lat'</span>: <span class="st">'Latitude'</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    ,<span class="st">'Last Update'</span>: <span class="st">'Last_Update'</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>all_data <span class="op">=</span> []</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>meta_data <span class="op">=</span> []</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="co"># For every file in our data set path</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> <span class="bu">sorted</span>(glob.glob(dataset_path)):</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1. Read the file to a temporary data frame</span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.read_csv(<span class="bu">file</span>).rename(columns<span class="op">=</span>col_pairs)</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2. Append a dictionary with the file meta_data into the metadata list</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>    meta_data.append( {  <span class="st">'file_name'</span>: <span class="bu">file</span>.rsplit(os.path.sep,<span class="dv">1</span>)[<span class="dv">1</span>]</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>                       , <span class="st">'num_rows'</span>: df.shape[<span class="dv">0</span>]</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>                       , <span class="st">'num_cols'</span>: df.shape[<span class="dv">1</span>]</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>                       , <span class="st">'col_names'</span>: <span class="st">'</span><span class="ch">\t</span><span class="st">'</span>.join(<span class="bu">sorted</span>(<span class="bu">list</span>(df.columns)))} )</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add the file name to the loaded data</span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'source_file'</span>] <span class="op">=</span> <span class="bu">file</span></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 4. Add the loaded data with the file name to a list with all the loaded data</span></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>    all_data.append(df)</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Create a table/dataframe out of our meta_data </span></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>meta_data <span class="op">=</span> pd.DataFrame(meta_data)</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a><span class="co"># output result to notebook window</span></span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a>meta_data.groupby([<span class="st">'num_cols'</span>])<span class="op">\</span></span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a>         .agg({ <span class="st">'num_rows'</span>: <span class="st">'sum'</span></span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>              , <span class="st">'file_name'</span>: <span class="bu">sorted</span></span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a>              , <span class="st">'col_names'</span>: <span class="bu">set</span> })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">num_rows</th>
<th data-quarto-table-cell-role="th">file_name</th>
<th data-quarto-table-cell-role="th">col_names</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">num_cols</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2818</td>
<td>[01-22-2020.csv, 01-23-2020.csv, 01-24-2020.csv, 01-25-2020.csv, 01-26-2020.csv, 01-27-2020.csv, 01-28-2020.csv, 01-29-2020.csv, 01-30-2020.csv, 0...</td>
<td>{Confirmed\tCountry_Region\tDeaths\tLast_Update\tProvince_State\tRecovered}</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>4799</td>
<td>[03-01-2020.csv, 03-02-2020.csv, 03-03-2020.csv, 03-04-2020.csv, 03-05-2020.csv, 03-06-2020.csv, 03-07-2020.csv, 03-08-2020.csv, 03-09-2020.csv, 0...</td>
<td>{Confirmed\tCountry_Region\tDeaths\tLast_Update\tLatitude\tLongitude\tProvince_State\tRecovered}</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>75773</td>
<td>[03-22-2020.csv, 03-23-2020.csv, 03-24-2020.csv, 03-25-2020.csv, 03-26-2020.csv, 03-27-2020.csv, 03-28-2020.csv, 03-29-2020.csv, 03-30-2020.csv, 0...</td>
<td>{Active\tAdmin2\tCombined_Key\tConfirmed\tCountry_Region\tDeaths\tFIPS\tLast_Update\tLatitude\tLongitude\tProvince_State\tRecovered}</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-74" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>d_data <span class="op">=</span> pd.concat(all_data</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                  , axis<span class="op">=</span><span class="st">'index'</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                  , join<span class="op">=</span><span class="st">'outer'</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>                  , ignore_index<span class="op">=</span><span class="va">True</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>                  , sort<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>d_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Active</th>
<th data-quarto-table-cell-role="th">Admin2</th>
<th data-quarto-table-cell-role="th">Combined_Key</th>
<th data-quarto-table-cell-role="th">Confirmed</th>
<th data-quarto-table-cell-role="th">Country_Region</th>
<th data-quarto-table-cell-role="th">Deaths</th>
<th data-quarto-table-cell-role="th">FIPS</th>
<th data-quarto-table-cell-role="th">Last_Update</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">Province_State</th>
<th data-quarto-table-cell-role="th">Recovered</th>
<th data-quarto-table-cell-role="th">source_file</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>Anhui</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>14.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>Beijing</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>6.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>Chongqing</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.0</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>Fujian</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Mainland China</td>
<td>NaN</td>
<td>NaN</td>
<td>1/22/2020 17:00</td>
<td>NaN</td>
<td>NaN</td>
<td>Gansu</td>
<td>NaN</td>
<td>us_jhu_data/csse_covid_19_data/csse_covid_19_daily_reports/01-22-2020.csv</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="solution-for-problem-3" class="level1">
<h1>Solution for problem 3</h1>
<div id="cell-76" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'us_jhu_data/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-77" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.melt(  id_vars<span class="op">=</span>[<span class="st">'Province/State'</span>, <span class="st">'Country/Region'</span>, <span class="st">'Lat'</span>, <span class="st">'Long'</span>]</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>        , var_name<span class="op">=</span><span class="st">'report_date'</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>        , value_name<span class="op">=</span><span class="st">'confirmed_cases'</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>df.rename(columns<span class="op">=</span>{<span class="st">'Country/Region'</span>: <span class="st">'Country'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-78" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pycountry</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Mainland China'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">'China'</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Macau'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">'China'</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'South Korea'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">'Republic of Korea'</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Korea, South'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">'Republic of Korea'</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Ivory Coast'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"Republic of Cote d'Ivoire"</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'North Ireland'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"United Kingdom"</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Republic of Ireland'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"Ireland"</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'St. Martin'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"France"</span> </span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Iran (Islamic Republic of)'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"Iran"</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'West Bank and Gaza'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"Palestine"</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Channel Islands'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"UK"</span> <span class="co">## Not technically, but effectively, great tax laws</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>].isin([ <span class="st">'Congo (Brazzaville)'</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>                                    ,<span class="st">'Congo (Kinshasa)'</span>]), <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">'Congo'</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Gambia, The'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"Gambia"</span> </span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Bahamas, The'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"Bahamas"</span> </span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Cape Verde'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">'Republic of Cabo Verde'</span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'East Timor'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">'Timor-Leste'</span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Laos'</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">"Lao People's Democratic Republic"</span> </span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>df.loc[ df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">"Burma"</span>, <span class="st">'Country'</span>] <span class="op">=</span> <span class="st">'Myanmar'</span></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a><span class="co"># dropping disputed teritories and not teritories</span></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(df[df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Others'</span>].index)</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(df[df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Taipei and environs'</span>].index)</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(df[df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'occupied Palestinian territory'</span>].index) </span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(df[df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Taiwan*'</span>].index)</span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(df[df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Taiwan'</span>].index)</span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(df[df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'MS Zaandam'</span>].index)</span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(df[df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Cruise Ship'</span>].index)</span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(df[df[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'Diamond Princess'</span>].index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-79" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>countries <span class="op">=</span> pd.Series(df[<span class="st">'Country'</span>].unique())</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_iso(country_name):</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">'Country'</span>:country_name, <span class="st">'ISO_3'</span>: pycountry.countries.search_fuzzy(country_name)[<span class="dv">0</span>].alpha_3}</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>countries <span class="op">=</span> pd.DataFrame(<span class="bu">list</span>(countries.<span class="bu">map</span>(get_iso)))</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.merge(countries</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>            , on<span class="op">=</span><span class="st">'Country'</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>            , how<span class="op">=</span><span class="st">'inner'</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>            , validate<span class="op">=</span><span class="st">'m:1'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-80" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Province/State</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Lat</th>
<th data-quarto-table-cell-role="th">Long</th>
<th data-quarto-table-cell-role="th">report_date</th>
<th data-quarto-table-cell-role="th">confirmed_cases</th>
<th data-quarto-table-cell-role="th">ISO_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>Afghanistan</td>
<td>33.000000</td>
<td>65.000000</td>
<td>1/22/20</td>
<td>0</td>
<td>AFG</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>Afghanistan</td>
<td>33.000000</td>
<td>65.000000</td>
<td>1/23/20</td>
<td>0</td>
<td>AFG</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>Afghanistan</td>
<td>33.000000</td>
<td>65.000000</td>
<td>1/24/20</td>
<td>0</td>
<td>AFG</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>Afghanistan</td>
<td>33.000000</td>
<td>65.000000</td>
<td>1/25/20</td>
<td>0</td>
<td>AFG</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>NaN</td>
<td>Afghanistan</td>
<td>33.000000</td>
<td>65.000000</td>
<td>1/26/20</td>
<td>0</td>
<td>AFG</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22180</td>
<td>NaN</td>
<td>Yemen</td>
<td>15.552727</td>
<td>48.516388</td>
<td>4/11/20</td>
<td>1</td>
<td>YEM</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22181</td>
<td>NaN</td>
<td>Yemen</td>
<td>15.552727</td>
<td>48.516388</td>
<td>4/12/20</td>
<td>1</td>
<td>YEM</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22182</td>
<td>NaN</td>
<td>Yemen</td>
<td>15.552727</td>
<td>48.516388</td>
<td>4/13/20</td>
<td>1</td>
<td>YEM</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22183</td>
<td>NaN</td>
<td>Yemen</td>
<td>15.552727</td>
<td>48.516388</td>
<td>4/14/20</td>
<td>1</td>
<td>YEM</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22184</td>
<td>NaN</td>
<td>Yemen</td>
<td>15.552727</td>
<td>48.516388</td>
<td>4/15/20</td>
<td>1</td>
<td>YEM</td>
</tr>
</tbody>
</table>

<p>22185 rows × 7 columns</p>
</div>
</div>
</div>
<div id="cell-81" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>df[pd.isnull(df[<span class="st">'ISO_3'</span>])]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Province/State</th>
<th data-quarto-table-cell-role="th">Country</th>
<th data-quarto-table-cell-role="th">Lat</th>
<th data-quarto-table-cell-role="th">Long</th>
<th data-quarto-table-cell-role="th">report_date</th>
<th data-quarto-table-cell-role="th">confirmed_cases</th>
<th data-quarto-table-cell-role="th">ISO_3</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-82" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>viz2 <span class="op">=</span> <span class="op">\</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>df.groupby(by<span class="op">=</span>[<span class="st">'report_date'</span>, <span class="st">'ISO_3'</span>, <span class="st">'Country'</span>])<span class="op">\</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>      .agg({<span class="st">'confirmed_cases'</span>: <span class="st">'sum'</span>})<span class="op">\</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>      .reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-83" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>viz2[<span class="st">'sqrt_Confirmed'</span>] <span class="op">=</span> np.sqrt(viz2[<span class="st">'confirmed_cases'</span>].clip(lower<span class="op">=</span><span class="dv">1</span>)) <span class="co"># calculate the square root of the confirmed</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                                                                <span class="co"># cases, clip the columns lower values to at </span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>                                                                <span class="co"># least 1.</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> <span class="op">\</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>px.choropleth(viz2</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>             , locations<span class="op">=</span><span class="st">'ISO_3'</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>             , locationmode<span class="op">=</span><span class="st">'ISO-3'</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>             , animation_frame<span class="op">=</span><span class="st">'report_date'</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>             , hover_data<span class="op">=</span>[<span class="st">'confirmed_cases'</span>, <span class="st">'Country'</span>]</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>             , animation_group<span class="op">=</span><span class="st">'ISO_3'</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>             , color<span class="op">=</span><span class="st">'sqrt_Confirmed'</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>             , color_continuous_scale<span class="op">=</span> [[<span class="dv">0</span>,  <span class="st">'rgba(0, 255, 0, .07)'</span> ]</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>                                        ,[<span class="fl">0.5</span>, <span class="st">'green'</span>]</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>                                        ,[<span class="dv">1</span>, <span class="st">'palegreen'</span>]]</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>             , template<span class="op">=</span><span class="st">'plotly_dark'</span>)</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.plotly.v1+json</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/JorickvdHoeven\.github\.io\/jorickvdhoeven\.github\.io\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>